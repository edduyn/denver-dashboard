<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Denver Satellite Dashboard</title>
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;Denver Dashboard&quot;,&quot;short_name&quot;:&quot;Denver&quot;,&quot;display&quot;:&quot;standalone&quot;}">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #fff; min-height: 100vh; }
        
        /* Login Screen */
        .login-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .login-box { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 20px; padding: 40px; text-align: center; max-width: 400px; width: 100%; }
        .login-box h1 { color: #f59e0b; margin-bottom: 10px; font-size: 1.8em; }
        .login-box p { color: #94a3b8; margin-bottom: 30px; }
        .login-box input { width: 100%; padding: 15px; border: 2px solid #334155; background: #1e293b; color: #fff; border-radius: 10px; font-size: 16px; margin-bottom: 15px; }
        .login-box input:focus { outline: none; border-color: #f59e0b; }
        .login-box button { width: 100%; padding: 15px; background: #f59e0b; color: #000; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .login-box button:hover { background: #d97706; }
        .error-msg { color: #ef4444; margin-top: 10px; display: none; }
        
        /* Main Dashboard */
        .dashboard { display: none; min-height: 100vh; }
        .header { background: rgba(0,0,0,0.3); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .logo { height: 40px; }
        .header h1 { font-size: 1.3em; color: #f59e0b; }
        .header-right { display: flex; gap: 10px; align-items: center; }
        .header-btn { padding: 8px 15px; border-radius: 8px; border: none; cursor: pointer; font-size: 14px; font-weight: 500; }
        .btn-full { background: #3b82f6; color: #fff; }
        .btn-rotate { background: #10b981; color: #fff; }
        .btn-lock { background: #64748b; color: #fff; }
        .status-indicator { padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .status-active { background: #10b981; color: #fff; }
        .status-paused { background: #ef4444; color: #fff; }
        
        /* Tabs */
        .tabs { display: flex; background: rgba(0,0,0,0.2); padding: 10px; gap: 5px; overflow-x: auto; }
        .tab { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500; white-space: nowrap; transition: all 0.3s; }
        .tab:hover { background: rgba(255,255,255,0.1); }
        .tab.active { background: #f59e0b; color: #000; }
        .tab-goals { border-left: 3px solid #8b5cf6; }
        .tab-actions { border-left: 3px solid #ef4444; }
        .tab-overview { border-left: 3px solid #3b82f6; }
        .tab-employees { border-left: 3px solid #10b981; }
        .tab-workorders { border-left: 3px solid #f97316; }
        .tab-quotes { border-left: 3px solid #ec4899; }
        .tab-quality { border-left: 3px solid #06b6d4; }
        .tab-rankings { border-left: 3px solid #eab308; }
        .tab-wip { border-left: 3px solid #22c55e; }
        .tab-training { border-left: 3px solid #a855f7; }
        
        /* Content */
        .content { padding: 20px; display: none; }
        .content.active { display: block; }
        
        /* Cards */
        .card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 15px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .card-title { font-size: 1.1em; color: #f59e0b; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        
        /* Metrics */
        .metric { text-align: center; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px; }
        .metric-value { font-size: 2em; font-weight: bold; color: #f59e0b; }
        .metric-label { color: #94a3b8; font-size: 0.9em; margin-top: 5px; }
        .metric-sub { color: #64748b; font-size: 0.8em; }
        
        /* Progress Bars */
        .progress-container { margin: 10px 0; }
        .progress-bar { height: 20px; background: #334155; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 10px; transition: width 0.5s; }
        .progress-green { background: linear-gradient(90deg, #10b981, #34d399); }
        .progress-amber { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-red { background: linear-gradient(90deg, #ef4444, #f87171); }
        
        /* Tables */
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { color: #f59e0b; font-weight: 600; }
        tr:hover { background: rgba(255,255,255,0.05); }
        
        /* Status Badges */
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8em; font-weight: 600; }
        .badge-green { background: #10b981; color: #fff; }
        .badge-amber { background: #f59e0b; color: #000; }
        .badge-red { background: #ef4444; color: #fff; }
        .badge-blue { background: #3b82f6; color: #fff; }
        .badge-gray { background: #64748b; color: #fff; }
        
        /* Goal Cards */
        .goal-card { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-bottom: 12px; }
        .goal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .goal-title { font-weight: 600; }
        .goal-progress { display: flex; align-items: center; gap: 10px; }
        .goal-pct { font-size: 1.2em; font-weight: bold; }
        .goal-notes { color: #94a3b8; font-size: 0.85em; margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); }
        
        /* Action Items */
        .action-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 8px; }
        .action-check { width: 24px; height: 24px; border: 2px solid #64748b; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .action-check.checked { background: #10b981; border-color: #10b981; }
        .action-check.checked::after { content: '‚úì'; color: #fff; font-weight: bold; }
        .action-text { flex: 1; }
        .action-priority { padding: 2px 8px; border-radius: 4px; font-size: 0.75em; }
        .priority-high { background: #ef4444; color: #fff; }
        .priority-med { background: #f59e0b; color: #000; }
        
        /* Alert Banner */
        .alert-banner { background: linear-gradient(90deg, #ef4444, #dc2626); padding: 15px 20px; text-align: center; font-weight: 600; }
        
        /* Rankings specific */
        .rank-item { display: flex; align-items: center; gap: 15px; padding: 10px; border-radius: 8px; margin-bottom: 5px; }
        .rank-item.denver { background: rgba(245, 158, 11, 0.2); border: 2px solid #f59e0b; }
        .rank-num { width: 30px; height: 30px; background: #334155; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .rank-shop { flex: 1; }
        .rank-value { font-weight: bold; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .card-grid { grid-template-columns: 1fr 1fr; }
            .header h1 { font-size: 1.1em; }
            .metric-value { font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <h1>üõ©Ô∏è Denver Satellite</h1>
            <p>Department 889 Performance Dashboard</p>
            <input type="password" id="passwordInput" placeholder="Enter access code" onkeypress="if(event.key==='Enter')login()">
            <button onclick="login()">Access Dashboard</button>
            <p class="error-msg" id="errorMsg">Invalid access code</p>
        </div>
    </div>
    
    <!-- Main Dashboard -->
    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="header-left">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAAyCAYAAAAZUZThAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABHKSURBVHgB7V0JeFTV2X7PzGQnK0kghH0HZZFFBEURFFFRq1ZttW5V61K1Wpe6VO3ij9Zaa7VuRatVXKruooKKuIMbICCrbCHsEJYQQhKyzv+dc+6dO5NlMlkm+H/P8zBz7z3n3HPufM/3ne875wYYgQWwgGYBKxhvAdagPSBAxNh/rjEEE+eXY+G5pUZwxVHA+UOAUZ8AR58NHH4xQAcTkOc7ZwNvTwVe+w3wjwlA0Vot91VgPF8z6TjghgEENmzg3D4aWtPtNPRrAp2XpJzPJXL8TqEATkzUUkqaBBQXAkuuAl6dYAazk9qDJv4DovDhJGD0QuDqYUByP4Cnd/B5Ru+6UhpKCcQ7wIB7gcO3AGcc4gJWFQBJ/VT9WkZaLwCuP0bWP+Nx4M2vtJw2Zq/xxNZR1I5hAcn9AIwbE8tB2h3p6U4KLHKC6F8LrHsFWPgAcMKHwMLXgXMO1u7j/X8Gvv4XOPNuoMdEIIoJb95vgG8+0HI/ucwYxqFSHs8f9ZeQr6V0lgJ3PN+JOC6/D3h7AnDmQOCNGcDPJgJDHgZmTgemLDGJ7xdx2iNX6rJY6JXIvABh5M8Evv0AWHon8G/KxTPAqYOAr78E1lwNPDhMW8PF2cBJxwBfzBQ9+eWjtHp/sxB47nNNzgqyLIU4fhJmfn4u8MZU7TqKOCXZJCfdAVz0kJYrE0ZXLrNdH+VdU0LGLOwK9Bur/T9tpSbPX0A23YXA7J9qWq7I6t9qn/o5U8o3+Ry44TgtRU9gGwvgypeFSv2bAq0/nh9A8gD24NlCYG45W/t/d4GQm3kS/Vv5Zzxy+SHApyO1MuXlWt5gCTCTaZ8f0N4jIDvq6lxN/y4+TJPVNwLYtFfTvFNW8TW8g0k1TW3d36uqKlCi/LGJKbhxYCqOPqIEcYm2F7WM5bScpnVf4LGEyF/UVwDxAcYKOhSdBLSzwTcFPm9X1VXYGR2FXmkpGJSQhMMO31e4LSCGPz2N3ZpL0JcSGJCURPknCTMnxuLqd+K0uq5JgvBXDvEkptB2U8z/kTx3oJDQzQ6NwNQBQMkhWl4fG3TvdU5yJp6MT8KWogIsLorlI1QmxYQQnA+RvXVDJG7pn4y+MTR3fGIQHyMIr3U6wTFDCCwSaLBIDqGQ+I6A71Kz8o5S2pGfAb/pBBx7pZYy4C/X2Nwf0HJVFpEPaG2FIoLGQJAXVScUVVTC5/NhdHQ0zkyNw83RMbilXzK6R0ciVOj5w5GHhuhOiJKv3CJI73whNYE5K3v4bXhLkL1lJfk0jHQ+R23dFbiyZzL6dOuBGLqeM4Mj8Oe4SNzYKwnd6B7eVJkQPr9P8wpCRJ+RqcXFiIpMCFp9oO3IIZ5bSRD+NuKrYggWANZ6ABTt0FKIv+kvpg1dg2H4TdIE0VCYE/T1VW6BYwnh3CfkNpPK+ygzBGmLfn/pexT5XLmG5hYCG8K3wGr3bwAOIeIcE0jf0ULaJz6aDKL4FCLnELBmM/DWVi0XFkvJOTSEd2S1xxjlKKzBbqqWV5dNbG+u/FtbYRvd/Y/EABxeCNhG0y+hX5E+OhSqQRiTiQfxKl3bTCStxqSxQk0L8R5avhbE3VIhOX8HcHkO8GC2VuZf6dp3aNf9I0FLObcfhehcX0WBYDdq2BDJgOZ8EnLThXS9h3R9JlF7Nen0NeS7n3T9e5JuXwqUbJUjJZMwhXRdIoQjjCAShHgqkLuYEiW7lxI1j5OQTyJS7qM6t1M4l8ywgdpoD12vPqRbnw/RkGynEPk7RL7/JCGW0fd3JAj7KITYSmV20P2vJfI+Q/cfIZ/T6VpHUuIDlL+U7puHuMxaVjAJy/y06xNJWEXEuZdCsnWk00O0gPVkj3Gt4kKgqJBiR7L7+I5BuoU0LxLoJuoIcusyCqEQOlMkYYIQ1kfA8gMdDOlRVAYU9W7E4OU7CHzv5BYsI7JNJ93m0u8P6P5vkP6/I4JtTQv9NM2z0oMUdHQ4aDxBfQw3F9C1cok4T9M67CMBshCpLjXNdB+V+x8hRQbJr4jI8D9qe0cK52Q7hWNkc49qfhdSuX/TtRupnfUU4q8mnSeSTv8mIpdRmWK6xkJqM5fu8zS1U0L14ynB+P4L6F7vkD5fpXqPkX5KKJz6L4XZc2m9z9MqfER1e9HnbJKVU1v7U9l30e8L6bMpBBgO7jUCYOJ+IPUQgqBPUBlzYqSJ0EhEKEvd0NdGdP23OATnNrJTcxZnKjvJYu7zk0nqnKQ6tEiSe/8xJO3+FQL8gQhxCYVqb1P+M9Q2E4PHpLfnAI50BDw4kH1cJNiAfPYnUlxL13uT2tiWvmfa/4fE+F9bNUCj/x1xpJ0UpJEsJ4CIGzNAqERtjAEw4Sgtu4L0vIPKXUt13qD6t1KCsf/X0ucmCjvfI+KNJy5YQvL8F72e7xMSzCJu4e+/Iv3fSqS5imo6nMKPuYzJwHW7a6k6MciLNJdO0yI/B70OfOB7gK8h/pjDq0+J6+S8Ru1yqnsdqoLQ6FE5f5MQkRcTUa4hYn1BBCA9MiGeo+wM9wgS86VsqusqSpz2vIrWjj8nAj5GoWIyhUi/SxCGG6VJb/wHfTLbYiKWWIvfJu6YS7/5OyRLNRH0EapjA4UwxVSmO7Vn5n0VUP8NijG4huJxIhdvJbDT/v8lcvP9EinBKLSaQqQZSonbiKy+3Qm4ePb1d4k7HqN7cyj0NpXxNtXxKtV1NKVlpNdP6HP87p+k+1Mpu4Duzy4SJ02n+79N+X2o7utJzh/TfZdRnoiJSYQmopFsPZvamU/3upx+J9CCM+k+k4gY1Xzti+k+E0j+TdTOxyGdGYuIuIUCqC+p/g5kJO4nYvNK/Hy6N4fIt1GoOpUI/zl9P4fkuYbqGcF1Ennuo3pvovL+Q4lfpHj3oPvNoLo/pXv+jwi1gar7hD7Po/sso/vnUvqS7r2J7vsM3eMY8rC3EFne0wYUFQJlxdTH1O5uAgr3/YqmcZqGCPTNvSSiR5Ck2lLdS0mWKRQuJJLcNxApbiDdk/j/sZTvH9TGxaRfJrdB+o2iazxA+c+h6z2W5NlBfbaT2thIIvyRiHMpYesqumYefV5L+uX7X0+fs+nePahPGDvWkB7vo3tfRv1wGX0m0Xf+/wHVdw/V/zGR8Xa6/r6kvztIvlv43pT/BIUwRZTNoLJvkjxDqN5/04KwnO6zhIi6O33/HNV3A/UJ/z+IFoQ/UHs7KY/n/qj5hBTqS/Oo/ggic9lOQvY2IqWP8u+j+r9OhJ9A5b+A2hpM5Z9C2BRLdebRQo+nRbGMyn1CZf6HyrFhYf6RQva+lL5bRwQ0Fx1F1A/sTF9L95hK9XwZISfh6XgPJdj/z9Tn66nO1ylPk2YBecWRWshDhP4HkYgXCH4IkO7JhBhL8lxC97iY8i+i+xPf3E5ECqf7xRCdDQu/R6TvDnYJNhOxZxJRJgUj6QryeN9T3pnUDvfHrdTGn4lQ6ST7K1TmHyR7Ll1/GWHWV1T2bepvXqzmEx+9Qi7DEPrN8o+gtp+m9j6l39dQ/hqqw3xKHRASFpI+c6neFfR7NrWTQ6ldqH8n0D0mUJts1F6g+i+l3w9Sm8uoHKdDKMzLpzJLqE4jdtNiVHEVcbdYr2bk+MgJEuuTa3gNfJh6hUItb8bR47Rg6SRIdYF0s8ijNJfqjCdyMDkuo4SZT78zyHW9R4Tj5+ffn6bpzf9vpFCiuJxyc+h+nLzX0fcr6fpMJB7vQ/mZFCo9HgjJliTrCCHH0vfdyE2EAYlbSBf8uwx9I1E/jqaRwVziInpAUmYihTsXsS2kNF6ij5DuY+7PJA1+Z6PiEqJ3KUiw9q2c3hzyOgKFVLSGPZLqnUokbQOCpPwS4rsn6TdPWHgnEVX8oknZ70m2V+n3O/T7K7oHk+q7xhSnRANDLXOo7lIqyyFOPBH+FMJBXrDz4VFkdI6nbN7bvZ3qfIu0xP8PILIdSx5qJnmEuPAgn5EMRX5H3IXueYZckDtJcV//L0rjWM7F9Dkx8Nuh/n2Q7vVTKnMOhSC/I45aSm38iDzHdSTXkZR/Oc+3n3j6U0Ii5cG4qBXqQy7qOvo/yLCifdIj1nEH/9jvujbSg7b1xfQNTl9RXK9RQR7hO69lEI4lfZ5kkIg3UNaJHVTXvMCzlLK47K3kk7TybNsIZ2upX5Y6gzTJ1nf67ybyT9Ri9WPKvJMlzAhiMv4c1fCYZY9mL7vTtejk15fJHkPoMUu0L5WbDCdBPm2lBTx5LNfU+jGuI66x7mUTk4Ihqa4gPKH0/UWUl7u0+n028Ih3sMU7rxEdfwN4aE/E6r1dVbnU7QGfULa4fXrKSrLt1XCZD2fCHkzEeRQsmRhdK+pJC+7qhdkYpAkPLLIPIr+T0i2NyhNfZbaMWIp5zV1lY6mcrVp9BPH2KNK+YuUF6tyvqH8HCoykfT7TzKufLg45WMTXGZaSudReWuYPpfKl1EXvpnaPJKu8+OQ7nSS4x9ElKPY9DqPrmce+5jyM+j+HXWJJSV7yGi6meT6ZTCGiTe4jCBPVAu5qY16j6d0LMk4hsixHx1mxe19h/5+g+R+mNK0oDCpjup8g7RU4uxpTBNB4jzJ0+Qh0u/8lDrOpIXjPAqJr6LPgyndzVbFOSzpYeKAd4mkE4iMw6kvphCxL6f+TSqluK2WSncN+Y0Lqe1L6P4xPPGbSfd5kO71IhHvTiJFZ+r7aSSLeTDQWFqk82nupeTpeND/CKqLw8cqakeCyHU65Z1GpKcHEzA+Qd5PqT+uoc+bw0Lsj+l+RjypVNePSSej8YKuhp+bMYNFNBdJEX0y8G8y7u+SzFPIW8VT/jm0mHxPsk6ltILK5lD5KPqcLxRpLZ0I2Zh+PpRqmU0hkZoMIT1T3X2fovsmhdjnB9VOJNXJoTfvi7qFiDSRjOG3ySCtIWQbqX/vJnlyHf5K9w8h2ZZR3VeSDtLIQp9CfZFI9Z0ZYqF5QkJrOZ7qPJLKZwQvDHGJQI0FVFiQAMDJuhZ+k8ivJAiwxMQlI1Gd+o/kvI4IJQ4LSqD7HkYhA+/VnExZW0aEa3AaQRzVL5SHYLGLfAgtAm8QHGdQu/wdA15qbEJmD6MKqJGfktHvHORVMwERnT1GOB3Y+jL1S5mL7BwOj5FmAONzC5AudKbVnKTq2S2C+pLLOPGKd+X5O7rkGiJdBEqKEEHCR6Jkm9C/MgCgO+ltNf3fMhQd2NbpPAvKM4WyQ+T8S+IA+8/2/jzYTJYQQgdoZ3kTa0tZtGPpKh6hy/I+R0YTe60E8hSPpMw8asuHU4jRLm6yBdMpj07SZk05LBPRj2T14dAe1hEoIShD0FJC30hAtUMYpKBkE32qfqH2c4gUvYhETHQeYLaGQhXehs2H3C2KvkCfJURqXjSiKeTvQLoyJPR6Cul2pPsfGkjH93B7eoYw5EfQh8DFpEslLVL7EhF+L2F8DfBc+3v02TJk2n8h8rYhdBB2tLIe9CgP5Oiltn0eNuxTkHSi2YnSuOBcBLVnb+DUfTvKp2oqNMJKzS2g+rgHBN0knW2w3qGFjY/cZvZxJBT7fF5gPyLgOzq8z0yG5lHHdqSwJi7E9o+GrKXwZCi9r6XQaQ8V60Vh4Q40kJxqgX9AcqRaAtSIPZhIbO7xW4fMc8nYJdmzHHJ0IPlupPPNOpK8y3tUn3M+hRCPkGE08zG8kPQ5SOJQC0FHSv1j6I/qD4InSq1kbHOI5v8LqluaF3T7fOi1EBJaAMcz0TJxGW/xCU+HH7xwwb6efvBCEd/X+nkF6yjvYJLtwDAlzn9rINf/BSu/v/p/AP/CwLpMBN9GAAAAAElFTkSuQmCC" class="logo" alt="Duncan Aviation">
                <h1>Denver Satellite (889)</h1>
            </div>
            <div class="header-right">
                <span class="status-indicator" id="statusIndicator">Ready</span>
                <button class="header-btn btn-full" onclick="toggleFullscreen()">‚õ∂ Full</button>
                <button class="header-btn btn-rotate" id="rotateBtn" onclick="toggleRotate()">‚ñ∂Ô∏è Auto</button>
                <button class="header-btn btn-lock" onclick="logout()">üîí Lock</button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab tab-goals active" data-tab="goals">üéØ Goals</div>
            <div class="tab tab-actions" data-tab="actions">‚ö° Actions</div>
            <div class="tab tab-overview" data-tab="overview">üìä Overview</div>
            <div class="tab tab-employees" data-tab="employees">üë• Employees</div>
            <div class="tab tab-workorders" data-tab="workorders">üìã Work Orders</div>
            <div class="tab tab-training" data-tab="training">üìö Training</div>
            <div class="tab tab-quality" data-tab="quality">‚úÖ Quality</div>
            <div class="tab tab-wip" data-tab="wip">üí∞ WIP</div>
            <div class="tab tab-rankings" data-tab="rankings">üèÜ Rankings</div>
        </div>
        
        <!-- GOALS TAB -->
        <div class="content active" id="goals">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">2026 Performance Goals - Overall Progress</span>
                    <span class="badge badge-amber">45% Complete</span>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#1 Financial Objectives (A/B Ratio + ELR)</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#ef4444">28%</span>
                            <span class="badge badge-red">At Risk</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-red" style="width:28%"></div></div>
                    </div>
                    <div>Current: 25.0% A/B | Target: 58.5% | Gap: -33.5 pts</div>
                    <div class="goal-notes">‚ö†Ô∏è 20th of 21 satellites. Focus on billable hours and reducing shop time.</div>
                </div>
                
                <div class="goal-card" style="border:2px solid #a855f7;">
                    <div class="goal-header">
                        <span class="goal-title">#2 Net Promoter Score (NPS) - Customer Satisfaction</span>
                        <div class="goal-progress">
                            <span id="npsGoalPct" class="goal-pct" style="color:#ef4444">0%</span>
                            <span id="npsGoalBadge" class="badge badge-red">Action Needed!</span>
                        </div>
                    </div>
                    <!-- Completed Surveys -->
                    <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                        <span style="font-size:0.85em;color:#10b981;width:80px;">‚úÖ Completed</span>
                        <div class="progress-container" style="flex:1;margin:0;">
                            <div class="progress-bar"><div id="npsCompletedBar" class="progress-fill progress-green" style="width:0%"></div></div>
                        </div>
                        <span id="npsCompletedCount" style="font-size:0.85em;color:#94a3b8;width:60px;">0 / 12</span>
                    </div>
                    <!-- Sent vs Billed WOs -->
                    <div style="display:flex;align-items:center;gap:10px;">
                        <span style="font-size:0.85em;color:#a855f7;width:80px;">üìß Sent</span>
                        <div class="progress-container" style="flex:1;margin:0;">
                            <div class="progress-bar"><div id="npsSentBar" class="progress-fill" style="width:0%;background:linear-gradient(90deg,#a855f7,#c084fc);"></div></div>
                        </div>
                        <span id="npsSentCount" style="font-size:0.85em;color:#94a3b8;width:70px;">0 / 41</span>
                    </div>
                    <div id="npsGoalSummary" style="margin-top:10px;">Target: 1/month (12/yr) | Sent vs Billed WOs: 0/41</div>
                    <div class="goal-notes">üìû Peregrine (DTBLA) now billed - good NPS candidate! See Actions tab.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#3 Training Completion</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#f59e0b">14%</span>
                            <span class="badge badge-amber">In Progress</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-amber" style="width:14%"></div></div>
                    </div>
                    <div>Training: 0/14 sessions completed | Technical: 3/8 scheduled (38%)</div>
                    <div class="goal-notes">‚è≥ 14 sessions available. ‚ö†Ô∏è 5 techs still need technical training dates scheduled.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#4 Flat-Rate System Evaluation</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#f59e0b">15%</span>
                            <span class="badge badge-amber">In Progress</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-amber" style="width:15%"></div></div>
                    </div>
                    <div>Phase: Analysis | Next Meeting: March 9, 2026</div>
                    <div class="goal-notes">üìä Jan 8 kickoff complete. 3-tier structure decided. Creating tier classification criteria.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#5 Customer Communication & Response Times</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#64748b">N/A</span>
                            <span class="badge badge-gray">Not Started</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-amber" style="width:0%"></div></div>
                    </div>
                    <div>Target: Same-day response, phone coverage during business hours</div>
                    <div class="goal-notes">üìû Need to establish baseline metrics and tracking system.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#6 Shop Expenses Within Budget</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#64748b">0%</span>
                            <span class="badge badge-gray">Awaiting Data</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-amber" style="width:0%"></div></div>
                    </div>
                    <div>Current: Awaiting financial data | Target: ‚â§2.5% of revenue</div>
                    <div class="goal-notes">üìä Expense data available after month-end financial reports.</div>
                </div>
                
                <div class="goal-card" style="border:2px solid #ef4444;">
                    <div class="goal-header">
                        <span class="goal-title">#7 FAA/Internal Audits - Zero Findings</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#ef4444">5</span>
                            <span class="badge badge-red">5 Findings</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill" style="width:100%;background:#ef4444"></div></div>
                    </div>
                    <div>2026 YTD: 1 audit (Jan 21) | <span style="color:#ef4444;font-weight:bold;">5 findings (1 repeat)</span></div>
                    <div class="goal-notes">‚ö†Ô∏è Jan audit: Flame locker (REPEAT), parts tagging (CTQMA, CU0VA), work area. See Quality tab for corrective actions.</div>
                </div>
                
                <div class="goal-card" style="border:2px solid #f59e0b;">
                    <div class="goal-header">
                        <span class="goal-title">#8 Monthly A/B Budget Performance</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#ef4444">0/12</span>
                            <span class="badge badge-red">0% Months Met</span>
                        </div>
                    </div>
                    <!-- Year Progress Bar -->
                    <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
                        <span style="font-size:0.8em;color:#f59e0b;width:100px;">üéØ Year Goal</span>
                        <div class="progress-container" style="flex:1;margin:0;">
                            <div class="progress-bar"><div class="progress-fill" style="width:0%;background:linear-gradient(90deg,#ef4444,#f59e0b);"></div></div>
                        </div>
                        <span style="font-size:0.85em;color:#94a3b8;width:80px;">0 / 12 mo</span>
                    </div>
                    <!-- Monthly Tracking Table -->
                    <div class="table-container" style="max-height:200px;overflow-y:auto;margin:10px 0;">
                        <table style="font-size:0.8em;">
                            <thead>
                                <tr><th>Month</th><th>Target</th><th>Actual</th><th>Gap</th><th>Status</th></tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(239,68,68,0.2);">
                                    <td><strong>Jan</strong></td>
                                    <td>58.5%</td>
                                    <td style="color:#ef4444;font-weight:bold;">25.8%</td>
                                    <td style="color:#ef4444;">-31.8 pts</td>
                                    <td><span style="color:#ef4444;">üî¥ In Progress</span></td>
                                </tr>
                                <tr><td>Feb</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Mar</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Apr</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>May</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Jun</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Jul</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Aug</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Sep</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Oct</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Nov</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                                <tr><td>Dec</td><td>58.5%</td><td style="color:#64748b;">--</td><td>--</td><td><span style="color:#64748b;">‚è≥ Upcoming</span></td></tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- Summary Stats -->
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:10px;">
                        <div style="background:#1e293b;padding:8px;border-radius:6px;text-align:center;">
                            <div style="color:#64748b;font-size:0.7em;">MONTHS MET</div>
                            <div style="color:#ef4444;font-size:1.2em;font-weight:bold;">0 / 12</div>
                        </div>
                        <div style="background:#1e293b;padding:8px;border-radius:6px;text-align:center;">
                            <div style="color:#64748b;font-size:0.7em;">CURRENT TREND</div>
                            <div style="color:#f59e0b;font-size:1.2em;font-weight:bold;">25.8%</div>
                        </div>
                        <div style="background:#1e293b;padding:8px;border-radius:6px;text-align:center;">
                            <div style="color:#64748b;font-size:0.7em;">YEAR PROJECTION</div>
                            <div style="color:#ef4444;font-size:1.2em;font-weight:bold;">0/12</div>
                        </div>
                    </div>
                    <div class="goal-notes">üìä <strong>Tracker System:</strong> ‚úÖ Implemented | <strong>Execution:</strong> Need +31.8 pts to hit Jan target. Focus on billable hour assignments.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#9 Dealer Programs Utilization</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#10b981">100%</span>
                            <span class="badge badge-green">On Track</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-green" style="width:100%"></div></div>
                    </div>
                    <div>2026 Programs: <strong>1 Completed</strong> / 1 Total | WO: DUSFA (Concorde Holdings)</div>
                    <div class="goal-notes">‚úÖ DP2026.00486 Collins CASP - Completed. Tracking 2026 programs only.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#10 Vendor Disputes Communication</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#10b981">100%</span>
                            <span class="badge badge-green">On Track</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-green" style="width:100%"></div></div>
                    </div>
                    <div>Target: Communicate to BZ within 30 days of dispute | <strong>2026 Emails: 1</strong></div>
                    <div class="goal-notes">‚úÖ CG4NA communicated 1/21. Forward BZ emails to Claude for tracking.</div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <span class="goal-title">#11 Risk Assessment</span>
                        <div class="goal-progress">
                            <span class="goal-pct" style="color:#64748b">N/A</span>
                            <span class="badge badge-gray">Not Started</span>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar"><div class="progress-fill progress-amber" style="width:0%"></div></div>
                    </div>
                    <div>Target: Identify and document risk areas for Denver operations</div>
                    <div class="goal-notes">üìã Need to complete risk assessment documentation.</div>
                </div>
            </div>
        </div>
        
        <!-- ACTIONS TAB -->
        <div class="content" id="actions">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">‚òÄÔ∏è Morning Checklist</span>
                    <span class="badge badge-green" id="morningDate">--/--/--</span>
                </div>
                <div class="action-item"><div class="action-check" data-checklist="morning" data-item="0" onclick="toggleDailyCheck(this)"></div><span class="action-text">Review yesterday's Time Sold report</span><span id="morning-note-0" class="checklist-note" style="color:#94a3b8;font-size:0.8em;margin-left:auto;"></span></div>
                <div class="action-item"><div class="action-check" data-checklist="morning" data-item="1" onclick="toggleDailyCheck(this)"></div><span class="action-text">Check Anchor for WOs ready to bill</span><span id="morning-note-1" class="checklist-note" style="color:#94a3b8;font-size:0.8em;margin-left:auto;"></span></div>
                <div class="action-item"><div class="action-check" data-checklist="morning" data-item="2" onclick="toggleDailyCheck(this)"></div><span class="action-text">Assign techs to billable customer work first</span></div>
                <div class="action-item"><div class="action-check" data-checklist="morning" data-item="3" onclick="toggleDailyCheck(this)"></div><span class="action-text">Touch base with low performers</span><span style="color:#f59e0b;font-size:0.8em;margin-left:auto;">Douglas, Ken, Jose</span></div>
                <div id="morningReportStatus" style="background:#0f172a;padding:8px;border-radius:6px;margin-top:10px;font-size:0.75em;color:#94a3b8;">
                    üìä <strong>Reports processed:</strong> <span id="reportStatusText">Waiting for today's reports...</span>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üåô End of Day Checklist</span>
                    <span class="badge badge-green" id="eveningDate">--/--/--</span>
                </div>
                <div class="action-item"><div class="action-check" data-checklist="evening" data-item="0" onclick="toggleDailyCheck(this)"></div><span class="action-text">Pull daily reports (Time Sold, Billed, Anchor)</span><span id="evening-note-0" class="checklist-note" style="color:#94a3b8;font-size:0.8em;margin-left:auto;"></span></div>
                <div class="action-item"><div class="action-check" data-checklist="evening" data-item="1" onclick="toggleDailyCheck(this)"></div><span class="action-text">Upload to Claude for analysis</span><span id="evening-note-1" class="checklist-note" style="color:#94a3b8;font-size:0.8em;margin-left:auto;"></span></div>
                <div class="action-item"><div class="action-check" data-checklist="evening" data-item="2" onclick="toggleDailyCheck(this)"></div><span class="action-text">Bill any completed WOs (within 1 week target)</span><span id="evening-note-2" class="checklist-note" style="color:#94a3b8;font-size:0.8em;margin-left:auto;"></span></div>
                <div class="action-item"><div class="action-check" data-checklist="evening" data-item="3" onclick="toggleDailyCheck(this)"></div><span class="action-text">Plan tomorrow's assignments</span></div>
                <div id="eveningResultStatus" style="background:#0f172a;padding:8px;border-radius:6px;margin-top:10px;font-size:0.75em;color:#94a3b8;">
                    üìà <strong>Today's results:</strong> <span id="resultsStatusText">Complete checklist to see results</span>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üö® Critical Actions</span>
                    <span class="badge badge-red">Urgent</span>
                </div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">‚≠ê NPS Survey - One-Click in Goals tab - READY!</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">Douglas Riera Guzman - improved to 8h billable (keep momentum)</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">Guillermo Tovar S. - improved to 36% (good progress!)</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">CG4NA - 188 days old, vendor dispute (Kauffman)</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">Watson, Andrew - MidYear Review due Feb 4 (7 days)</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">Guillermo Tovar S. - 90-Day Review due Feb 8 (11 days)</span><span class="action-priority priority-high">HIGH</span></div>
                <div class="action-item"><div class="action-check" onclick="this.classList.toggle('checked')"></div><span class="action-text">Reply to Brian Zitek Over 30 list with WO notes</span><span class="action-priority priority-high">HIGH</span></div>
            </div>
            
            <!-- TIME SOLD COMPLIANCE TRACKER -->
            <div class="card" style="border:2px solid #f97316;">
                <div class="card-header">
                    <span class="card-title">‚è∞ Time Sold Compliance</span>
                    <span class="badge" id="timeSoldBadge" style="background:#f97316;">Check Required</span>
                </div>
                
                <div style="background:#0f172a;padding:12px;border-radius:8px;margin-bottom:15px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <span style="color:#94a3b8;font-size:0.85em;">üìÖ Checking for date:</span>
                        <input type="date" id="timeSoldCheckDate" onchange="renderTimeSoldCompliance()" style="padding:6px 10px;border-radius:6px;border:none;background:#1e293b;color:white;font-size:0.9em;">
                    </div>
                    <div style="display:flex;gap:10px;">
                        <button onclick="setTimeSoldDateYesterday()" style="flex:1;padding:8px;background:#3b82f6;color:white;border:none;border-radius:6px;font-size:0.85em;cursor:pointer;">Yesterday</button>
                        <button onclick="setTimeSoldDateLastBusinessDay()" style="flex:1;padding:8px;background:#10b981;color:white;border:none;border-radius:6px;font-size:0.85em;cursor:pointer;">Last Business Day</button>
                    </div>
                </div>
                
                <!-- Employee Status Grid -->
                <div id="timeSoldGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px;margin-bottom:15px;">
                    <!-- Dynamically populated -->
                </div>
                
                <!-- Summary Stats -->
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:15px;">
                    <div style="background:#14532d;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#86efac;font-size:0.75em;">‚úÖ SOLD TIME</div>
                        <div id="timeSoldCount" style="color:#4ade80;font-size:1.5em;font-weight:bold;">0</div>
                    </div>
                    <div style="background:#7f1d1d;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#fca5a5;font-size:0.75em;">‚ùå NO TIME SOLD</div>
                        <div id="noTimeSoldCount" style="color:#f87171;font-size:1.5em;font-weight:bold;">0</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.75em;">üìä COMPLIANCE</div>
                        <div id="timeSoldCompliance" style="color:#f59e0b;font-size:1.5em;font-weight:bold;">--%</div>
                    </div>
                </div>
                
                <!-- Non-Compliant List with Email Buttons -->
                <div id="nonCompliantSection" style="display:none;">
                    <div style="background:rgba(239,68,68,0.15);border:1px solid #ef4444;border-radius:8px;padding:15px;">
                        <div style="color:#f87171;font-weight:bold;margin-bottom:10px;">‚ö†Ô∏è Employees Who Did NOT Sell Time</div>
                        <div class="table-container" style="max-height:200px;overflow-y:auto;">
                            <table id="nonCompliantTable" style="font-size:0.85em;">
                                <thead>
                                    <tr><th>Employee</th><th>Email</th><th>Action</th></tr>
                                </thead>
                                <tbody id="nonCompliantBody">
                                    <!-- Dynamically populated -->
                                </tbody>
                            </table>
                        </div>
                        <button onclick="sendAllTimeSoldReminders()" style="width:100%;margin-top:10px;padding:12px;background:linear-gradient(135deg,#dc2626,#ef4444);color:white;border:none;border-radius:8px;font-weight:bold;cursor:pointer;">üìß Send Reminder to ALL Non-Compliant</button>
                    </div>
                </div>
                
                <!-- All Compliant Message -->
                <div id="allCompliantSection" style="display:none;background:#14532d;padding:15px;border-radius:8px;text-align:center;">
                    <div style="color:#86efac;font-size:1.2em;">‚úÖ All employees sold time on this date!</div>
                </div>
                
                <!-- Employee Database Management -->
                <div style="background:#1e293b;padding:12px;border-radius:8px;margin-top:15px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <span style="color:#94a3b8;font-size:0.85em;">üë• Employee Database: <span id="employeeDbCount">0</span> employees</span>
                        <button onclick="toggleEmployeeManager()" style="background:#475569;color:white;border:none;padding:5px 10px;border-radius:4px;font-size:0.8em;cursor:pointer;">‚öôÔ∏è Manage</button>
                    </div>
                    
                    <div id="employeeManager" style="display:none;margin-top:10px;">
                        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:10px;">
                            <input type="text" id="newEmpName" placeholder="Employee Name" style="padding:8px;border-radius:6px;border:none;background:#0f172a;color:white;font-size:0.85em;">
                            <input type="text" id="newEmpCode" placeholder="Emp Code (e.g. SMIKZ)" style="padding:8px;border-radius:6px;border:none;background:#0f172a;color:white;font-size:0.85em;text-transform:uppercase;">
                            <input type="email" id="newEmpEmail" placeholder="Email" style="padding:8px;border-radius:6px;border:none;background:#0f172a;color:white;font-size:0.85em;">
                        </div>
                        <button onclick="addEmployeeToDb()" style="width:100%;padding:8px;background:#10b981;color:white;border:none;border-radius:6px;font-size:0.85em;cursor:pointer;">‚ûï Add Employee</button>
                        <div id="empAddMsg" style="display:none;margin-top:5px;font-size:0.8em;text-align:center;"></div>
                        
                        <div class="table-container" style="max-height:150px;overflow-y:auto;margin-top:10px;">
                            <table style="font-size:0.8em;">
                                <thead><tr><th>Name</th><th>Code</th><th>Email</th><th></th></tr></thead>
                                <tbody id="employeeDbBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Time Sold Data Input -->
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.75em;color:#94a3b8;">
                    üí° <strong>How to use:</strong> When Claude processes your Time Sold report, ask it to update the "employees who sold time" list. Use <code>updateTimeSoldData('YYYY-MM-DD', ['EMPCODE1', 'EMPCODE2', ...])</code> in console.
                </div>
            </div>
            
            <div class="card" style="border:2px solid #60a5fa;">
                <div class="card-header">
                    <span class="card-title">üìÖ Weekly Goals</span>
                    <span class="badge badge-blue">Week of 01/27</span>
                </div>
                
                <!-- Goal 1: A/B Target -->
                <div style="background:#1e293b;padding:12px;border-radius:8px;margin-bottom:10px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <span style="color:#e2e8f0;">üìä A/B Target: Get to 30%+ by Friday</span>
                        <span id="weeklyABStatus" class="badge badge-amber">In Progress</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:10px;">
                        <div class="progress-container" style="flex:1;margin:0;">
                            <div class="progress-bar">
                                <div id="weeklyABBar" class="progress-fill" style="width:89%;background:linear-gradient(90deg,#f59e0b,#fbbf24);"></div>
                            </div>
                        </div>
                        <span id="weeklyABText" style="color:#fbbf24;font-weight:bold;min-width:100px;text-align:right;">25.8% / 30%</span>
                    </div>
                    <div style="color:#94a3b8;font-size:0.8em;margin-top:5px;">Need +3.3 pts by Fri | Currently 20th rank</div>
                </div>
                
                <!-- Goal 2: Aging WO Closures -->
                <div style="background:#1e293b;padding:12px;border-radius:8px;margin-bottom:10px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <span style="color:#e2e8f0;">üìã Close 5+ WOs from 90+ day aging list</span>
                        <span id="weeklyAgingStatus" class="badge badge-amber">2 / 5</span>
                    </div>
                    <div style="display:flex;gap:5px;flex-wrap:wrap;">
                        <span style="background:#10b981;color:white;padding:2px 8px;border-radius:4px;font-size:0.8em;">‚úÖ DTBLA</span>
                        <span style="background:#10b981;color:white;padding:2px 8px;border-radius:4px;font-size:0.8em;">‚úÖ DSW4A</span>
                        <span style="background:#374151;color:#9ca3af;padding:2px 8px;border-radius:4px;font-size:0.8em;">‚¨ú 3 more needed</span>
                    </div>
                    <div style="color:#94a3b8;font-size:0.8em;margin-top:5px;">CG4NA (188 days) still in dispute</div>
                </div>
                
                <!-- Goal 3: Rank Improvement -->
                <div style="background:#1e293b;padding:12px;border-radius:8px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <span style="color:#e2e8f0;">üèÜ Move up to 18th rank (pass St. Louis & KC)</span>
                        <span id="weeklyRankStatus" class="badge badge-red">20th ‚Üí 18th</span>
                    </div>
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;font-size:0.85em;">
                        <div style="text-align:center;padding:5px;background:#0f172a;border-radius:4px;">
                            <div style="color:#94a3b8;">18th St. Louis</div>
                            <div style="color:#f59e0b;font-weight:bold;">28.2%</div>
                        </div>
                        <div style="text-align:center;padding:5px;background:#0f172a;border-radius:4px;">
                            <div style="color:#94a3b8;">19th KC</div>
                            <div style="color:#f59e0b;font-weight:bold;">27.5%</div>
                        </div>
                        <div style="text-align:center;padding:5px;background:#0f172a;border-radius:4px;border:1px solid #ef4444;">
                            <div style="color:#ef4444;">20th Denver</div>
                            <div style="color:#ef4444;font-weight:bold;">25.8%</div>
                        </div>
                    </div>
                    <div style="color:#94a3b8;font-size:0.8em;margin-top:5px;">Need +1.5 pts to pass KC, +2.3 pts to pass St. Louis</div>
                </div>
            </div>
            
            <!-- NPS SURVEY CANDIDATES -->
            <div class="card" style="border:2px solid #a855f7;">
                <div class="card-header">
                    <span class="card-title">‚≠ê NPS Survey - Goal #2</span>
                    <span class="badge" id="npsBadge" style="background:#ef4444;">Jan: 0/1 ‚ö†Ô∏è</span>
                </div>
                
                <!-- Stats Banner -->
                <div id="npsStats" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:15px;">
                    <div style="background:#1e293b;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.7em;">SENT / BILLED</div>
                        <div id="statSent" style="color:#60a5fa;font-size:1.3em;font-weight:bold;">0/41</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.7em;">COMPLETED</div>
                        <div id="statCompleted" style="color:#10b981;font-size:1.5em;font-weight:bold;">0</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.7em;">PENDING</div>
                        <div id="statPending" style="color:#f59e0b;font-size:1.5em;font-weight:bold;">0</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.7em;">RESPONSE RATE</div>
                        <div id="statRate" style="color:#a855f7;font-size:1.5em;font-weight:bold;">-</div>
                    </div>
                </div>
                
                <div style="background:linear-gradient(135deg,#581c87,#7c3aed);padding:20px;border-radius:10px;margin-bottom:15px;">
                    <div style="color:#e9d5ff;font-size:0.9em;margin-bottom:15px;font-weight:bold;">üìß SEND NPS SURVEY</div>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:10px;">
                        <div>
                            <label style="color:#c4b5fd;font-size:0.8em;display:block;margin-bottom:5px;">Customer Name *</label>
                            <input type="text" id="npsCustomerName" placeholder="Peregrine" style="width:100%;padding:10px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:1em;">
                        </div>
                        <div>
                            <label style="color:#c4b5fd;font-size:0.8em;display:block;margin-bottom:5px;">WO# *</label>
                            <input type="text" id="npsWO" placeholder="DTBLA" style="width:100%;padding:10px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:1em;text-transform:uppercase;">
                        </div>
                    </div>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;">
                        <div>
                            <label style="color:#c4b5fd;font-size:0.8em;display:block;margin-bottom:5px;">Customer Email *</label>
                            <input type="email" id="npsCustomerEmail" placeholder="customer@email.com" style="width:100%;padding:10px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:1em;">
                        </div>
                        <div>
                            <label style="color:#c4b5fd;font-size:0.8em;display:block;margin-bottom:5px;">Aircraft Registration (optional)</label>
                            <input type="text" id="npsRegNumber" placeholder="N12345 or leave blank" style="width:100%;padding:10px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:1em;text-transform:uppercase;">
                        </div>
                    </div>
                    
                    <div style="display:grid;grid-template-columns:2fr 1fr;gap:10px;">
                        <button onclick="logNpsSurvey(true)" style="padding:15px;background:linear-gradient(135deg,#10b981,#059669);color:white;border:none;border-radius:8px;font-size:1em;font-weight:bold;cursor:pointer;">
                            üìß Send & Log Survey
                        </button>
                        <button onclick="logNpsSurvey(false)" style="padding:15px;background:#475569;color:white;border:none;border-radius:8px;font-size:0.9em;cursor:pointer;">
                            üìù Log Only
                        </button>
                    </div>
                    
                    <div id="npsError" style="display:none;color:#fca5a5;font-size:0.85em;margin-top:10px;text-align:center;">‚ö†Ô∏è Please enter customer name and email</div>
                    <div id="npsSuccess" style="display:none;color:#86efac;font-size:0.85em;margin-top:10px;text-align:center;">‚úÖ Survey logged!</div>
                </div>
                
                <!-- Tracking Table -->
                <div style="background:#0f172a;padding:15px;border-radius:8px;margin-bottom:15px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <span style="color:#a855f7;font-weight:bold;">üìä Survey Tracking Log</span>
                        <button id="clearLastNps" style="background:#f59e0b;color:white;border:none;padding:4px 10px;border-radius:4px;font-size:0.75em;cursor:pointer;">Undo Last</button>
                    </div>
                    <div class="table-container" style="max-height:200px;overflow-y:auto;">
                        <table id="npsTrackingTable" style="font-size:0.85em;">
                            <thead>
                                <tr><th>Date</th><th>Customer</th><th>WO#</th><th>Status</th><th>Score</th><th>Action</th></tr>
                            </thead>
                            <tbody id="npsTrackingBody">
                                <tr><td colspan="6" style="color:#64748b;text-align:center;">No surveys logged yet</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Dynamic Top Candidate - Shows highest revenue unsurveyed customer -->
                <div id="topCandidateSection" style="background:#1e293b;padding:12px;border-radius:8px;margin-bottom:15px;">
                    <div style="color:#94a3b8;font-size:0.85em;margin-bottom:8px;">üìã <strong>Top NPS Candidate (Highest Revenue Unsurveyed):</strong></div>
                    <div id="topCandidateContent" style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;">
                        <!-- Dynamically populated -->
                    </div>
                </div>
                
                <!-- Add New Customer Form -->
                <div style="background:linear-gradient(135deg,#1e3a5f,#2563eb);padding:15px;border-radius:10px;margin-bottom:15px;">
                    <div style="color:#93c5fd;font-size:0.85em;margin-bottom:10px;font-weight:bold;">‚ûï ADD BILLED WO TO DATABASE</div>
                    <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr;gap:10px;margin-bottom:10px;">
                        <input type="text" id="newCustName" placeholder="Customer Name" style="padding:8px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:0.85em;">
                        <input type="email" id="newCustEmail" placeholder="Email" style="padding:8px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:0.85em;">
                        <input type="text" id="newCustWO" placeholder="WO#" style="padding:8px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:0.85em;text-transform:uppercase;">
                        <input type="text" id="newCustReg" placeholder="Reg# (opt)" style="padding:8px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:0.85em;text-transform:uppercase;">
                        <input type="number" id="newCustRevenue" placeholder="Revenue $" style="padding:8px;border-radius:6px;border:none;background:#1e1b4b;color:white;font-size:0.85em;">
                    </div>
                    <div style="display:flex;gap:10px;">
                        <button onclick="addCustomerToDb()" style="flex:1;padding:10px;background:#10b981;color:white;border:none;border-radius:6px;font-weight:bold;cursor:pointer;">‚ûï Add Customer</button>
                        <button onclick="clearCustomerDb()" style="padding:10px;background:#ef4444;color:white;border:none;border-radius:6px;cursor:pointer;font-size:0.85em;">üóëÔ∏è Clear All</button>
                    </div>
                    <div id="addCustMsg" style="display:none;margin-top:8px;font-size:0.8em;text-align:center;"></div>
                </div>
                
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                    <span style="color:#94a3b8;font-size:0.85em;">üìä Customer Email Database: <span id="customerDbCount">0</span> contacts with billed WO data</span>
                    <label style="font-size:0.8em;color:#94a3b8;cursor:pointer;">
                        <input type="checkbox" id="showSentCustomers" checked onchange="renderCustomerTable()" style="margin-right:5px;">
                        Show sent
                    </label>
                </div>
                <div class="table-container" style="max-height:300px;overflow-y:auto;">
                    <table>
                        <thead>
                            <tr><th>Customer</th><th>Email</th><th>WO#</th><th>Reg#</th><th>Revenue</th><th>Action</th></tr>
                        </thead>
                        <tbody id="customerDbBody">
                            <!-- Dynamically populated -->
                        </tbody>
                    </table>
                </div>
                <div id="npsDbSummary" style="background:#1e3a5f;padding:8px;border-radius:6px;margin-top:10px;font-size:0.8em;color:#93c5fd;">
                    üìã Add billed WOs above to track NPS surveys.
                </div>
                <div style="background:#0f172a;padding:8px;border-radius:6px;margin-top:5px;font-size:0.75em;color:#94a3b8;">
                    üí° <strong>Tip:</strong> When Claude processes your Billed WO report, ask it to provide customer data to add here.
                </div>
            </div>
        </div>
        
        <!-- OVERVIEW TAB -->
        <div class="content" id="overview">
            <div class="alert-banner">
                ‚ö†Ô∏è A/B RATIO: 25.8% vs 58.5% Target | Gap: -32.7 pts | Rank: 20th of 21
            </div>
            
            <!-- A/B COMPARISON CARD -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìä A/B Ratio Comparison</span>
                    <span class="badge badge-amber">Target: 58.5%</span>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
                    <div style="background:linear-gradient(135deg,#1e3a5f,#2563eb);padding:20px;border-radius:12px;text-align:center;">
                        <div style="color:#93c5fd;font-size:0.9em;margin-bottom:5px;">üìß MATT'S EMAIL (Official)</div>
                        <div style="font-size:2.8em;font-weight:bold;color:#ef4444;">26.8%</div>
                        <div style="color:#bfdbfe;font-size:0.85em;margin-top:8px;">2-week rolling thru Thu 1/22</div>
                        <div style="color:#fca5a5;font-size:0.9em;margin-top:5px;">Gap: -31.7 pts</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#14532d,#16a34a);padding:20px;border-radius:12px;text-align:center;">
                        <div style="color:#bbf7d0;font-size:0.9em;margin-bottom:5px;">üßÆ MY CALCULATED (MTD)</div>
                        <div style="font-size:2.8em;font-weight:bold;color:#ef4444;">25.8%</div>
                        <div style="color:#bbf7d0;font-size:0.85em;margin-top:8px;">Daily data thru Tue 1/28 AM</div>
                        <div style="color:#fca5a5;font-size:0.9em;margin-top:5px;">Gap: -31.8 pts</div>
                    </div>
                </div>
                <div style="margin-top:15px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;text-align:center;">
                    <div style="background:#1e293b;padding:10px;border-radius:6px;">
                        <div style="color:#94a3b8;font-size:0.8em;">Billable Hours</div>
                        <div style="color:#60a5fa;font-weight:bold;">462.0h</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:6px;">
                        <div style="color:#94a3b8;font-size:0.8em;">Paid Hours</div>
                        <div style="color:#f59e0b;font-weight:bold;">1,793h</div>
                    </div>
                    <div style="background:#1e293b;padding:10px;border-radius:6px;">
                        <div style="color:#94a3b8;font-size:0.8em;">Variance</div>
                        <div style="color:#fbbf24;font-weight:bold;">-0.1 pts</div>
                    </div>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#94a3b8;">
                    üí° <strong>Why different?</strong> Matt's = 2-wk rolling thru Thursday. Mine = daily MTD thru today.
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">January 2026 Metrics</span>
                    <span class="badge badge-blue">MTD - Updated 3:45 PM</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value">25.8%</div>
                        <div class="metric-label">Calculated A/B</div>
                        <div class="metric-sub">462h √∑ 1,793h</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">462h</div>
                        <div class="metric-label">Billable Hours</div>
                        <div class="metric-sub">Excl shop WO DT39A</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">$182K</div>
                        <div class="metric-label">Revenue MTD</div>
                        <div class="metric-sub">26% of $694K goal</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">42</div>
                        <div class="metric-label">Billed WOs</div>
                        <div class="metric-sub">$74.8K GP</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">2025 Reference (Full Year)</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value">47.6%</div>
                        <div class="metric-label">A/B Ratio</div>
                        <div class="metric-sub">vs 43.2% in 2024</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">$8.1M</div>
                        <div class="metric-label">Revenue</div>
                        <div class="metric-sub">+17% vs 2024</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">$1.01M</div>
                        <div class="metric-label">Net Income</div>
                        <div class="metric-sub">+91% vs 2024</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">106%</div>
                        <div class="metric-label">Budget Achievement</div>
                        <div class="metric-sub">Exceeded NI target</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- EMPLOYEES TAB -->
        <div class="content" id="employees">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Employee Performance - A/B Efficiency</span>
                    <span class="badge badge-amber">Target: 58.5%</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Rank</th><th>Employee</th><th>Billable</th><th>Total</th><th>A/B %</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(16,185,129,0.2)"><td>1</td><td>Sean Macoomb</td><td>93.0h</td><td>143.0h</td><td>65%</td><td><span class="badge badge-green">Above Target</span></td></tr>
                            <tr><td>2</td><td>Juan Medina</td><td>89.0h</td><td>175.0h</td><td>51%</td><td><span class="badge badge-amber">Below Target</span></td></tr>
                            <tr><td>3</td><td>Julia Langford</td><td>69.5h</td><td>143.0h</td><td>49%</td><td><span class="badge badge-amber">Below Target</span></td></tr>
                            <tr><td>4</td><td>Michael Huber</td><td>60.0h</td><td>143.5h</td><td>42%</td><td><span class="badge badge-amber">Below Target</span></td></tr>
                            <tr><td>5</td><td>Kim Owen</td><td>51.9h</td><td>148.5h</td><td>35%</td><td><span class="badge badge-amber">Below Target</span></td></tr>
                            <tr><td>6</td><td>Guillermo Tovar S.</td><td>46.5h</td><td>143.5h</td><td>32%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>7</td><td>Armando Triana-Cruz</td><td>38.5h</td><td>143.5h</td><td>27%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>8</td><td>Jose Noris</td><td>34.0h</td><td>146.0h</td><td>23%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>9</td><td>Ken Smith</td><td>26.0h</td><td>159.5h</td><td>16%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>10</td><td>Andrew Watson</td><td>21.0h</td><td>133.5h</td><td>16%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>11</td><td>John Watson</td><td>18.0h</td><td>144.0h</td><td>13%</td><td><span class="badge badge-red">Critical</span></td></tr>
                            <tr><td>12</td><td>Douglas Riera Guzman</td><td>11.0h</td><td>144.0h</td><td>8%</td><td><span class="badge badge-red">Critical</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üóìÔ∏è Upcoming Evaluations</span>
                    <span class="badge badge-amber">2 Due in 30 Days</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Date</th><th>Employee</th><th>Type</th><th>Days</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(245,158,11,0.2)"><td>02/04</td><td>Watson, Andrew</td><td>MidYear</td><td><span class="badge badge-amber">9</span></td></tr>
                            <tr style="background:rgba(245,158,11,0.2)"><td>02/08</td><td>Guillermo Tovar S.</td><td>90-Day</td><td><span class="badge badge-amber">13</span></td></tr>
                            <tr><td>03/10</td><td>Noris, Jose</td><td>Yearly</td><td>43</td></tr>
                            <tr style="background:rgba(100,116,139,0.2)"><td>07/15</td><td>Hannas, Michael üî¥ LOA</td><td>Yearly</td><td>170</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- WORK ORDERS TAB -->
        <div class="content" id="workorders">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Work Order Summary</span>
                    <span class="badge badge-blue">72 Open WOs</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value">72</div>
                        <div class="metric-label">Total Open WOs</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">42</div>
                        <div class="metric-label">Billed WOs (Jan)</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#10b981">$36,456</div>
                        <div class="metric-label">Total Open WIP</div>
                        <div class="metric-sub">üí∞ 295.9h unbilled</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#f59e0b">296h</div>
                        <div class="metric-label">Unbilled Hours</div>
                    </div>
                </div>
            </div>
            
            <!-- WIP BY SHOP -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üí∞ WIP by Shop (Open WOs)</span>
                    <span class="badge badge-blue">01/27/26 3:45 PM</span>
                </div>
                <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:15px;">
                    <div style="background:linear-gradient(135deg,#1e40af,#3b82f6);padding:15px;border-radius:10px;text-align:center;">
                        <div style="font-size:0.8em;color:#bfdbfe;">SDN (Line)</div>
                        <div style="font-size:1.8em;font-weight:bold;">$17,151</div>
                        <div style="font-size:0.8em;color:#93c5fd;">118.3h √ó $145</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#854d0e,#ca8a04);padding:15px;border-radius:10px;text-align:center;border:2px solid #fbbf24;">
                        <div style="font-size:0.8em;color:#fef3c7;">SDV (Install) ‚≠ê</div>
                        <div style="font-size:1.8em;font-weight:bold;">$6,020</div>
                        <div style="font-size:0.8em;color:#fde68a;">86.0h √ó $70</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#c2410c,#f97316);padding:15px;border-radius:10px;text-align:center;">
                        <div style="font-size:0.8em;color:#fed7aa;">SDR (Recip)</div>
                        <div style="font-size:1.8em;font-weight:bold;">$12,108</div>
                        <div style="font-size:0.8em;color:#fdba74;">83.5h √ó $145</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#475569,#64748b);padding:15px;border-radius:10px;text-align:center;">
                        <div style="font-size:0.8em;color:#cbd5e1;">SHC</div>
                        <div style="font-size:1.8em;font-weight:bold;">$0</div>
                        <div style="font-size:0.8em;color:#94a3b8;">0.0h √ó $145</div>
                    </div>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;font-size:0.85em;color:#94a3b8;">
                    üí° <strong>WIP Logic:</strong> Only WOs opened in current month. Prior month WOs already WIP'd.<br>
                    ‚≠ê <strong>SDV Special (for Matt):</strong> 75.0h / $5,250 (1 WO >10h: DB1UA). Note: DB1UA is NJ shop - Juan loaned hours. DUXFA not in Anchor (closed).
                </div>
            </div>
            
            <!-- TOP WIP WOs -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìã January WIP - Top WOs by Value</span>
                    <span class="badge badge-green">Open in Anchor (01/27/26)</span>
                </div>
                <div style="background:#14532d;padding:8px;border-radius:6px;margin-bottom:10px;font-size:0.8em;color:#bbf7d0;">
                    ü§ñ <strong>Auto-detected:</strong> Time Sold √ó Anchor (OPEN) √ó Billed (excluded)
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>WO#</th><th>Shop</th><th>Customer</th><th>Hours</th><th>Rate</th><th style="color:#10b981">WIP $</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>CTQMA</td><td>SDR</td><td>Robert P Husted <span style="color:#f59e0b;font-size:0.75em;">‚ö†Ô∏è audit</span></td><td>43.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$6,308</td></tr>
                            <tr style="background:rgba(147,51,234,0.15)"><td>DB1UA üìç</td><td>SDV</td><td>Hogs Head Air 1 LLC <span style="color:#a855f7;font-size:0.75em;">(NJ - Juan loaned)</span></td><td>75.0h</td><td style="color:#a855f7">$70</td><td style="color:#a855f7;font-weight:bold">$5,250</td></tr>
                            <tr><td>CU1EA</td><td>SDN</td><td>42K Re Management LLC</td><td>35.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$5,148</td></tr>
                            <tr style="background:rgba(16,185,129,0.25)"><td>CU16A ‚úÖ</td><td>SDN</td><td>Flying Orchard LLC <span style="color:#10b981;font-size:0.75em;">(billing this week)</span></td><td>30.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$4,422</td></tr>
                            <tr><td>CU0VA</td><td>SDR</td><td>The Club at Centennial <span style="color:#f59e0b;font-size:0.75em;">‚ö†Ô∏è audit</span></td><td>21.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$3,118</td></tr>
                            <tr><td>CUPFA</td><td>SDN</td><td>Flying Orchard LLC</td><td>15.9h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$2,306</td></tr>
                            <tr><td>CU92A</td><td>SDN</td><td>Robbins Aviation</td><td>15.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$2,175</td></tr>
                            <tr><td>CUL2A</td><td>SDR</td><td>Peregrine</td><td>12.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$1,812</td></tr>
                            <tr style="background:rgba(16,185,129,0.2);font-weight:bold;font-size:1.1em;">
                                <td colspan="4">TOP 8 WIP</td>
                                <td>249h</td>
                                <td style="color:#10b981">$30,539</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#94a3b8;">
                    üí° <strong>WIP = Work that will carry to February</strong> (if not billed by Jan 31). Excluded: DUXFA, CUS4A, DUL0A (not in Anchor - already closed/billed).
                </div>
            </div>
            
            <!-- SCHEDULED INSTALLS -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìÖ Scheduled Installs (SDV)</span>
                    <span class="badge badge-amber">Jan-Mar 2026</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Aircraft</th><th>Type</th><th>Work</th><th>Start</th><th>End</th><th>Days</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(59,130,246,0.15)">
                                <td><strong>N4QL</strong></td>
                                <td>Beechcraft B200</td>
                                <td>Artex ELT-1000 Install</td>
                                <td>Jan 27</td>
                                <td>Jan 29</td>
                                <td>3 days</td>
                                <td><span class="badge badge-blue">Firm</span></td>
                            </tr>
                            <tr style="background:rgba(59,130,246,0.15)">
                                <td><strong>N303JJ</strong></td>
                                <td>Lear 60</td>
                                <td>L3 Install</td>
                                <td>Feb 17</td>
                                <td>Mar 6</td>
                                <td>12 days</td>
                                <td><span class="badge badge-blue">Firm</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:10px;font-size:0.8em;color:#94a3b8;">
                    üìã Schedule IDs: N4QL (Schd:86035) | N303JJ (Schd:85877)
                </div>
            </div>
            
            <!-- WORK STATUS TRACKER - Calendar Correlation -->
            <div class="card" style="border:2px solid #8b5cf6;">
                <div class="card-header">
                    <span class="card-title">üìä Work Status Tracker - Calendar Correlation</span>
                    <span class="badge badge-purple">Days to Bill</span>
                </div>
                <div style="background:#14532d;padding:10px;border-radius:6px;margin-bottom:15px;font-size:0.85em;color:#bbf7d0;">
                    <strong style="color:#4ade80;">ü§ñ AUTO-CORRELATION:</strong> Anchor WOs √ó Calendar Events (SDN/SDR Service) | Updated: 01/27/26 PM
                </div>
                
                <!-- Status Summary -->
                <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:15px;">
                    <div style="background:linear-gradient(135deg,#1e40af,#3b82f6);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#93c5fd;">üîß In Progress</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">7</div>
                        <div style="font-size:0.7em;color:#bfdbfe;">Being worked today</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#065f46,#10b981);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#a7f3d0;">‚úÖ Worked On</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">4</div>
                        <div style="font-size:0.7em;color:#bbf7d0;">Review for billing</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#854d0e,#f59e0b);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#fef3c7;">üìÖ Scheduled</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">1</div>
                        <div style="font-size:0.7em;color:#fde68a;">Future work</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#7f1d1d,#ef4444);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#fecaca;">‚ö†Ô∏è Not Scheduled</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">59</div>
                        <div style="font-size:0.7em;color:#fca5a5;">Need review</div>
                    </div>
                </div>
                
                <!-- BILLING PRIORITY - Worked On but still Open -->
                <div style="background:rgba(16,185,129,0.15);border:1px solid #10b981;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#10b981;font-weight:bold;margin-bottom:10px;">üí∞ BILLING PRIORITY - Worked On, Still Open (Review These!)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Customer</th><th>Hours</th><th>WIP</th><th>Calendar Dates</th><th>Tech</th><th>Action</th></tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(16,185,129,0.25)"><td><strong>CU16A</strong> ‚úÖ</td><td>Flying Orchard</td><td>30.5h</td><td style="color:#10b981;font-weight:bold;">$4,422</td><td>Jan 5-7</td><td>HUBER/Julia</td><td style="color:#10b981;">Billing this week</td></tr>
                                <tr><td><strong>CU92A</strong></td><td>Robbins Aviation</td><td>15.0h</td><td style="color:#10b981;font-weight:bold;">$2,175</td><td>Jan 12-27</td><td>CRUZA/SMIKZ</td><td style="color:#f59e0b;">Ready to bill?</td></tr>
                                <tr><td><strong>CUPFA</strong></td><td>Flying Orchard</td><td>15.9h</td><td style="color:#10b981;font-weight:bold;">$2,306</td><td>Jan 19-21</td><td>HUBER</td><td style="color:#f59e0b;">Ready to bill?</td></tr>
                                <tr><td><strong>CV5EA</strong></td><td>Precision Aircraft</td><td>4.5h</td><td style="color:#10b981;font-weight:bold;">$653</td><td>Jan 20-21</td><td>CRUZA/SMIKZ</td><td style="color:#f59e0b;">Ready to bill?</td></tr>
                                <tr style="background:rgba(16,185,129,0.2);font-weight:bold;">
                                    <td colspan="3">POTENTIAL BILLING</td>
                                    <td style="color:#10b981;">$9,556</td>
                                    <td colspan="3" style="color:#10b981;">65.9h ready to convert to revenue</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Currently In Progress -->
                <div style="background:rgba(59,130,246,0.15);border:1px solid #3b82f6;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#3b82f6;font-weight:bold;margin-bottom:10px;">üîß IN PROGRESS TODAY (Jan 28)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Shop</th><th>Customer</th><th>Hours</th><th>Tech</th><th>End Date</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>CTQMA</td><td>SDR</td><td>Robert P Husted</td><td>43.5h</td><td>Macoomb</td><td>Jan 28</td></tr>
                                <tr><td>CU0VA</td><td>SDR</td><td>Aspen Flying Club</td><td>21.5h</td><td>Macoomb</td><td>Jan 28</td></tr>
                                <tr><td>CU1EA</td><td>SDN</td><td>42K RE MGMT</td><td>35.5h</td><td>HUBEM</td><td>Jan 28</td></tr>
                                <tr><td>CU97A</td><td>SDN</td><td>Circadian Aviation</td><td>12.0h</td><td>SMIKZ/CRUZA</td><td>Jan 28</td></tr>
                                <tr><td>CVN2A</td><td>SDN</td><td>IJET</td><td>0.0h</td><td>CRUZA/SMIKZ</td><td>Jan 31</td></tr>
                                <tr><td>CV2GA</td><td>SDN</td><td>E2 Holdings</td><td>0.0h</td><td>SMIKZ</td><td>Jan 28</td></tr>
                                <tr><td>CVLNA</td><td>SDN</td><td>Alpine Air</td><td>0.0h</td><td>SMIKZ</td><td>Jan 29</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Not Scheduled Warning -->
                <div style="background:rgba(239,68,68,0.15);border:1px solid #ef4444;border-radius:8px;padding:15px;">
                    <div style="color:#ef4444;font-weight:bold;margin-bottom:10px;">‚ö†Ô∏è NOT SCHEDULED - Top WOs with Hours (Need Calendar Entry)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Shop</th><th>Customer</th><th>Hours</th><th>WIP</th><th>Action Needed</th></tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(147,51,234,0.15)"><td>DB1UA üìç</td><td>SDV</td><td>Hogs Head Air 1 LLC</td><td>75.0h</td><td style="color:#a855f7;">$5,250</td><td style="color:#a855f7;font-size:0.8em;">NJ controlled - no action</td></tr>
                                <tr><td>CUL2A</td><td>SDR</td><td>Peregrine</td><td>12.5h</td><td>$1,812</td><td style="color:#ef4444;font-size:0.8em;">Add to SDR calendar</td></tr>
                                <tr><td>CV78A</td><td>SDV</td><td>Primus Capital</td><td>8.0h</td><td style="color:#fbbf24;">$560</td><td style="color:#ef4444;font-size:0.8em;">Add to SDV calendar</td></tr>
                                <tr><td>CVN0A</td><td>SDV</td><td>Stevens Aerospace</td><td>5.0h</td><td style="color:#fbbf24;">$350</td><td style="color:#ef4444;font-size:0.8em;">Add to SDV calendar</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top:10px;font-size:0.8em;color:#fca5a5;">
                        üìå 59 open WOs have no calendar entry. Many have 0 hours (may be holding WOs). 4 WOs shown above have significant hours without scheduling.
                    </div>
                </div>
                
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:15px;font-size:0.8em;color:#94a3b8;">
                    <strong style="color:#8b5cf6;">üìä DAYS TO BILL INSIGHT:</strong> 
                    "Worked On" WOs (4) totaling <strong style="color:#10b981;">$9,556</strong> may be ready for billing review. 
                    Calendar dates show work completed but WOs still open in Anchor.<br>
                    <span style="color:#64748b;">Data sources: SDN Service Calendar + SDR Service Calendar ‚Üí Anchor Report (01/27/26)</span>
                </div>
            </div>
            
            <!-- SDV EXPECTED HOURS TRACKER - Goal #4 -->
            <div class="card" style="border:2px solid #a855f7;">
                <div class="card-header">
                    <span class="card-title">üìä SDV Expected Hours Tracker (Goal #4)</span>
                    <span class="badge badge-amber">‚ö†Ô∏è 1/3 Have Estimates (33%)</span>
                </div>
                <div style="background:#14532d;padding:10px;border-radius:6px;margin-bottom:15px;font-size:0.85em;color:#bbf7d0;">
                    <strong style="color:#4ade80;">ü§ñ DATA SOURCE:</strong> Job View Report | SDV Shop Only | Updated: 01/27/26 3:44 PM
                </div>
                
                <!-- SDV Summary Cards -->
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:15px;">
                    <div style="background:linear-gradient(135deg,#581c87,#a855f7);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#e9d5ff;">SDV WOs with Hours</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">3</div>
                        <div style="font-size:0.7em;color:#d8b4fe;">Active work</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#7f1d1d,#ef4444);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#fecaca;">‚ö†Ô∏è No Estimate</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">2</div>
                        <div style="font-size:0.7em;color:#fca5a5;">Process gap!</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#065f46,#10b981);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#a7f3d0;">With Estimate</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">1</div>
                        <div style="font-size:0.7em;color:#bbf7d0;">Target: 100%</div>
                    </div>
                </div>
                
                <!-- SDV WOs Detail -->
                <div style="background:rgba(147,51,234,0.15);border:1px solid #a855f7;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#a855f7;font-weight:bold;margin-bottom:10px;">üìã SDV WOs - Expected Hours Status</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Customer</th><th>Actual Hrs</th><th>WIP @ $70</th><th>Exp Hrs</th><th>Status</th></tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(239,68,68,0.15)">
                                    <td><strong>DB1UA</strong> üìç</td>
                                    <td>Hogs Head Air 1 LLC</td>
                                    <td>73.0h</td>
                                    <td style="color:#a855f7;font-weight:bold;">$5,110</td>
                                    <td style="color:#ef4444;">‚ùå Not Set</td>
                                    <td style="color:#64748b;font-size:0.8em;">NJ controlled</td>
                                </tr>
                                <tr style="background:rgba(239,68,68,0.15)">
                                    <td><strong>CV78A</strong></td>
                                    <td>Primus Capital</td>
                                    <td>8.0h</td>
                                    <td style="color:#a855f7;font-weight:bold;">$560</td>
                                    <td style="color:#ef4444;">‚ùå Not Set</td>
                                    <td style="color:#ef4444;font-size:0.8em;">Add estimate</td>
                                </tr>
                                <tr style="background:rgba(16,185,129,0.15)">
                                    <td><strong>CVN0A</strong></td>
                                    <td>Stevens Aerospace</td>
                                    <td>5.0h</td>
                                    <td style="color:#a855f7;font-weight:bold;">$350</td>
                                    <td style="color:#10b981;">‚úÖ 41.0h</td>
                                    <td style="color:#10b981;font-size:0.8em;">Under estimate!</td>
                                </tr>
                                <tr style="background:rgba(147,51,234,0.2);font-weight:bold;">
                                    <td colspan="2">TOTAL SDV WIP</td>
                                    <td>86.0h</td>
                                    <td style="color:#a855f7;">$6,020</td>
                                    <td colspan="2" style="color:#f59e0b;">33% with estimates</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top:10px;font-size:0.85em;color:#d8b4fe;">
                        üìã <strong>Goal #4 requires expected hours tracking on SDV WOs.</strong> Currently 33% compliance - need estimates on DB1UA and CV78A.
                    </div>
                </div>
                
                <div style="background:#0f172a;padding:10px;border-radius:6px;font-size:0.8em;color:#94a3b8;">
                    <strong style="color:#a855f7;">üìä SDV TRACKING:</strong> 
                    SDV shop tracks Expected vs Actual hours to measure estimate accuracy. 
                    <strong style="color:#f59e0b;">Current gap: 2/3 WOs missing estimates (DB1UA, CV78A).</strong>
                </div>
            </div>
            
            <!-- FLAT RATE PROFITABILITY ANALYSIS - Actual Billed Data -->
            <div class="card" style="border:2px solid #10b981;">
                <div class="card-header">
                    <span class="card-title">üí∞ Flat Rate Profitability Analysis (January 2026 Billed)</span>
                    <span class="badge badge-green">‚úÖ System is PROFITABLE</span>
                </div>
                <div style="background:rgba(16,185,129,0.15);padding:10px;border-radius:6px;margin-bottom:15px;font-size:0.85em;color:#a7f3d0;">
                    <strong style="color:#10b981;">üìä DATA SOURCE:</strong> Billed WO Report (AS400) | 42 WOs | $182K Revenue | Updated: 01/27/26 3:40 PM
                </div>
                
                <!-- Profitability Summary Cards -->
                <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:15px;">
                    <div style="background:linear-gradient(135deg,#065f46,#10b981);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#a7f3d0;">Total Labor Billed</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">$51,687</div>
                        <div style="font-size:0.7em;color:#bbf7d0;">330.3 hours</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#1e3a5f,#3b82f6);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#bfdbfe;">If Hourly @$145</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">$47,894</div>
                        <div style="font-size:0.7em;color:#93c5fd;">Comparison baseline</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#065f46,#22c55e);padding:12px;border-radius:8px;text-align:center;border:2px solid #4ade80;">
                        <div style="font-size:0.75em;color:#bbf7d0;">Net Variance</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#4ade80;">+$3,793</div>
                        <div style="font-size:0.7em;color:#86efac;">üü¢ System profitable!</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#581c87,#a855f7);padding:12px;border-radius:8px;text-align:center;">
                        <div style="font-size:0.75em;color:#e9d5ff;">Effective Rate</div>
                        <div style="font-size:1.5em;font-weight:bold;color:#fff;">$156/hr</div>
                        <div style="font-size:0.7em;color:#d8b4fe;">vs $145 target</div>
                    </div>
                </div>
                
                <!-- Shop-by-Shop Profitability -->
                <div style="background:rgba(59,130,246,0.15);border:1px solid #3b82f6;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#3b82f6;font-weight:bold;margin-bottom:10px;">üìä Shop-by-Shop Profitability (Billed WOs)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>Shop</th><th>Billed WOs</th><th>Hours</th><th>Labor Billed</th><th>Hourly @$145</th><th>Variance</th><th>Eff Rate</th><th>Status</th></tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(16,185,129,0.15)">
                                    <td><strong>SDN</strong></td>
                                    <td>20</td>
                                    <td>127.6h</td>
                                    <td>$22,139</td>
                                    <td>$18,502</td>
                                    <td style="color:#10b981;font-weight:bold;">+$3,637</td>
                                    <td style="color:#10b981;">$174/hr</td>
                                    <td><span class="badge badge-green">üü¢ PROFIT</span></td>
                                </tr>
                                <tr style="background:rgba(16,185,129,0.15)">
                                    <td><strong>SDR</strong></td>
                                    <td>15</td>
                                    <td>109.3h</td>
                                    <td>$17,135</td>
                                    <td>$15,848</td>
                                    <td style="color:#10b981;font-weight:bold;">+$1,287</td>
                                    <td style="color:#10b981;">$157/hr</td>
                                    <td><span class="badge badge-green">üü¢ PROFIT</span></td>
                                </tr>
                                <tr style="background:rgba(239,68,68,0.1)">
                                    <td><strong>SHC</strong></td>
                                    <td>2</td>
                                    <td>13.0h</td>
                                    <td>$1,831</td>
                                    <td>$1,885</td>
                                    <td style="color:#ef4444;font-weight:bold;">-$54</td>
                                    <td style="color:#f59e0b;">$141/hr</td>
                                    <td><span class="badge badge-amber">‚ö†Ô∏è SLIGHT LOSS</span></td>
                                </tr>
                                <tr style="background:rgba(239,68,68,0.1)">
                                    <td><strong>SDV</strong></td>
                                    <td>5</td>
                                    <td>80.4h</td>
                                    <td>$10,582</td>
                                    <td>$11,658</td>
                                    <td style="color:#ef4444;font-weight:bold;">-$1,076</td>
                                    <td style="color:#ef4444;">$132/hr</td>
                                    <td><span class="badge badge-red">üî¥ LOSS</span></td>
                                </tr>
                                <tr style="background:rgba(16,185,129,0.2);font-weight:bold;">
                                    <td>TOTAL</td>
                                    <td>42</td>
                                    <td>330.3h</td>
                                    <td>$51,687</td>
                                    <td>$47,894</td>
                                    <td style="color:#10b981;">+$3,793</td>
                                    <td style="color:#10b981;">$156/hr</td>
                                    <td><span class="badge badge-green">‚úÖ NET PROFIT</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Top Profitable WOs -->
                <div style="background:rgba(16,185,129,0.15);border:1px solid #10b981;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#10b981;font-weight:bold;margin-bottom:10px;">üèÜ Most Profitable WOs (Top 5)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Shop</th><th>Hours</th><th>Labor Billed</th><th>Hourly @$145</th><th>Profit</th><th>Eff Rate</th></tr>
                            </thead>
                            <tbody>
                                <tr><td><strong>CUGZA</strong></td><td>SDN</td><td>17.9h</td><td>$5,444</td><td>$2,596</td><td style="color:#10b981;font-weight:bold;">+$2,849</td><td>$304/hr</td></tr>
                                <tr><td><strong>CU56A</strong></td><td>SDN</td><td>11.9h</td><td>$3,620</td><td>$1,726</td><td style="color:#10b981;font-weight:bold;">+$1,894</td><td>$304/hr</td></tr>
                                <tr><td><strong>CT8VA</strong></td><td>SDN</td><td>21.9h</td><td>$4,445</td><td>$3,176</td><td style="color:#10b981;font-weight:bold;">+$1,270</td><td>$203/hr</td></tr>
                                <tr><td><strong>CV5SA</strong></td><td>SHC</td><td>7.5h</td><td>$1,831</td><td>$1,088</td><td style="color:#10b981;font-weight:bold;">+$744</td><td>$244/hr</td></tr>
                                <tr><td><strong>CTVWA</strong></td><td>SDN</td><td>9.4h</td><td>$1,901</td><td>$1,363</td><td style="color:#10b981;font-weight:bold;">+$538</td><td>$202/hr</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Losing WOs -->
                <div style="background:rgba(239,68,68,0.15);border:1px solid #ef4444;border-radius:8px;padding:15px;margin-bottom:15px;">
                    <div style="color:#ef4444;font-weight:bold;margin-bottom:10px;">‚ö†Ô∏è WOs with Losses (Review Pricing)</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>WO#</th><th>Shop</th><th>Hours</th><th>Labor Billed</th><th>Hourly @$145</th><th>Loss</th><th>Issue</th></tr>
                            </thead>
                            <tbody>
                                <tr><td><strong>CU44A</strong></td><td>SDR</td><td>17.9h</td><td>$1,788</td><td>$2,596</td><td style="color:#ef4444;font-weight:bold;">-$807</td><td style="font-size:0.8em;">$100/hr rate</td></tr>
                                <tr><td><strong>CV3UA</strong></td><td>SHC</td><td>5.5h</td><td>$0</td><td>$798</td><td style="color:#ef4444;font-weight:bold;">-$798</td><td style="font-size:0.8em;">No labor billed</td></tr>
                                <tr><td><strong>DTBLA</strong></td><td>SDV</td><td>48.5h</td><td>$6,400</td><td>$7,032</td><td style="color:#ef4444;font-weight:bold;">-$632</td><td style="font-size:0.8em;">$132/hr rate</td></tr>
                                <tr><td><strong>DT13A, DT56A, DT99A</strong></td><td>SDN</td><td>12.0h</td><td>$0</td><td>$1,740</td><td style="color:#ef4444;font-weight:bold;">-$1,740</td><td style="font-size:0.8em;">No labor billed</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div style="background:#0f172a;padding:15px;border-radius:6px;font-size:0.85em;color:#94a3b8;">
                    <strong style="color:#10b981;">üìä KEY INSIGHTS:</strong><br>
                    ‚Ä¢ <strong>SDN & SDR are profitable</strong> - billing above $145/hr effective rate<br>
                    ‚Ä¢ <strong>SDV needs attention</strong> - effective rate $132/hr (losing $13/hr vs target)<br>
                    ‚Ä¢ <strong>Overall system is working</strong> - $3,793 profit vs hourly billing<br>
                    ‚Ä¢ <span style="color:#f59e0b;">Still need flat rate pricing report to see which specific service rates need adjustment</span>
                </div>
            </div>
            
            <!-- AGING ANALYSIS -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìÖ Top 10 Open WOs by WIP</span>
                    <span class="badge badge-blue">$36,456 Total WIP</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>WO#</th><th>Shop</th><th>Customer</th><th>Hours</th><th>Rate</th><th>WIP</th><th>Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>CTQMA</strong></td><td>SDR</td><td>Robert P Husted</td><td>43.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$6,308</td><td style="font-size:0.8em;">QA audit cited</td></tr>
                            <tr><td><strong>CU1EA</strong></td><td>SDN</td><td>42K RE MGMT</td><td>35.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$5,148</td><td style="color:#f59e0b;font-size:0.8em;">Push to bill</td></tr>
                            <tr><td><strong>DB1UA</strong> üìç</td><td>SDV</td><td>Hogs Head Air</td><td>73.0h</td><td>$70</td><td style="color:#a855f7;font-weight:bold;">$5,110</td><td style="color:#64748b;font-size:0.8em;">NJ controlled</td></tr>
                            <tr><td><strong>CU16A</strong></td><td>SDN</td><td>Flying Orchard</td><td>30.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$4,422</td><td style="color:#10b981;font-size:0.8em;">Billing this week</td></tr>
                            <tr><td><strong>CU0VA</strong></td><td>SDR</td><td>Club at Centennial</td><td>27.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$3,988</td><td style="font-size:0.8em;">QA audit cited</td></tr>
                            <tr><td><strong>CU97A</strong></td><td>SDN</td><td>Circadian Aviation</td><td>20.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$2,900</td><td style="color:#f59e0b;font-size:0.8em;">Review status</td></tr>
                            <tr><td><strong>CUPFA</strong></td><td>SDN</td><td>Flying Orchard</td><td>15.9h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$2,306</td><td style="color:#f59e0b;font-size:0.8em;">Same customer as CU16A</td></tr>
                            <tr><td><strong>CUL2A</strong></td><td>SDR</td><td>Peregrine</td><td>12.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$1,812</td><td style="font-size:0.8em;"></td></tr>
                            <tr><td><strong>CU92A</strong></td><td>SDN</td><td>Robbins Aviation</td><td>10.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$1,450</td><td style="color:#f59e0b;font-size:0.8em;">Review status</td></tr>
                            <tr><td><strong>CV2GA</strong></td><td>SDN</td><td>E2 Holdings</td><td>5.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold;">$725</td><td style="font-size:0.8em;"></td></tr>
                            <tr style="background:rgba(16,185,129,0.2);font-weight:bold;">
                                <td colspan="3">TOP 10 TOTAL</td>
                                <td>273.4h</td>
                                <td></td>
                                <td style="color:#10b981;">$34,168</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:10px;font-size:0.8em;color:#94a3b8;">
                    üìã Total open WIP: $36,456 (295.9h across all open WOs) | Data: 01/27/26 3:45 PM
                </div>
            </div>
            
            <!-- CRITICAL / AGING WOs -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">‚ö†Ô∏è Over 30 Days (BZ List)</span>
                    <span class="badge badge-green">‚úÖ CLEAR</span>
                </div>
                <div style="background:rgba(16,185,129,0.2);padding:15px;border-radius:6px;margin-bottom:15px;font-size:0.9em;border:2px solid #10b981;">
                    üéâ <strong style="color:#10b981;">Denver is in the clear!</strong> Per Brian's 01/28 email - only long-term dispute remains.
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>WO#</th><th>Shop</th><th>Days</th><th>WIP $</th><th>Status</th><th>Action/Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(16,185,129,0.2)"><td>DTBLA</td><td>SDV</td><td>40</td><td>$1,327</td><td><span class="badge badge-green">‚úÖ BILLED</span></td><td>Billed 01/26/26</td></tr>
                            <tr style="background:rgba(16,185,129,0.2)"><td>DSW4A</td><td>SDN</td><td>48</td><td>$52,763</td><td><span class="badge badge-green">‚úÖ BILLED</span></td><td>Billed before EOM ‚úÖ</td></tr>
                            <tr style="background:rgba(239,68,68,0.15)"><td>CG4NA</td><td>SDN</td><td>188</td><td>$2,486</td><td><span class="badge badge-red">üî¥ DISPUTE</span></td><td>Kauffman owner was in ICU, hope to resolve soon</td></tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#94a3b8;">
                    <strong style="color:#60a5fa;">üìã Data Sources:</strong> Over30 report (Brian) + Billed WO report (auto-detect billed status)<br>
                    <strong style="color:#f59e0b;">‚è∞ 30-Day Rule:</strong> Communicate to BZ within 30 days for any disputes
                </div>
            </div>
        </div>
        
        <!-- TRAINING TAB -->
        <div class="content" id="training">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">2026 Training Status</span>
                    <span class="badge badge-amber">In Progress</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value" style="color:#f59e0b">0/14</div>
                        <div class="metric-label">Training Completed</div>
                        <div class="metric-sub">14 sessions available</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#f59e0b">3/8</div>
                        <div class="metric-label">Technical Scheduled</div>
                        <div class="metric-sub">38% - Need 5 more</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">0</div>
                        <div class="metric-label">Completed YTD</div>
                        <div class="metric-sub">First: Jan 28-29</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#ef4444">5</div>
                        <div class="metric-label">Need Dates</div>
                        <div class="metric-sub">Action Required</div>
                    </div>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#94a3b8;">
                    üí° <strong>Tracking:</strong> Sessions completed / 14 available. Tell Claude when techs complete training to update count.
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Technical Training Schedule (from Cassie/PDT)</span>
                    <span class="badge badge-amber">5 Need Dates</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Employee</th><th>Course</th><th>Location</th><th>Dates</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(16,185,129,0.15)"><td>Armando Triana-Cruz</td><td>Honeywell Primus EPIC Line Maint</td><td>Dallas, TX</td><td>Apr 27 - May 1</td><td><span class="badge badge-green">‚úÖ Scheduled</span></td></tr>
                            <tr style="background:rgba(16,185,129,0.15)"><td>Michael Huber</td><td>Virtual Garmin G3000/G5000</td><td>Virtual</td><td>Jan 28-29</td><td><span class="badge badge-green">‚úÖ Scheduled</span></td></tr>
                            <tr style="background:rgba(16,185,129,0.15)"><td>Jose Noris</td><td>Virtual Garmin G1000 NXi</td><td>Virtual</td><td>Feb 26-27</td><td><span class="badge badge-green">‚úÖ Scheduled</span></td></tr>
                            <tr style="background:rgba(107,114,128,0.15)"><td>Michael Hannas</td><td>Collins Pro Line 21 Challenger</td><td>TBD</td><td>TBD</td><td><span class="badge badge-gray">‚è∏Ô∏è Medical Leave</span></td></tr>
                            <tr style="background:rgba(245,158,11,0.15)"><td>Julia Langford</td><td>Virtual Garmin G3000/G5000</td><td>Virtual</td><td>Pending</td><td><span class="badge badge-amber">‚ö†Ô∏è Select Dates</span></td></tr>
                            <tr style="background:rgba(245,158,11,0.15)"><td>Ken Smith</td><td>Virtual Gogo Dealer Training</td><td>Virtual</td><td>TBD</td><td><span class="badge badge-amber">‚ö†Ô∏è Dates TBD</span></td></tr>
                            <tr style="background:rgba(245,158,11,0.15)"><td>John Watson</td><td>aeroIT Certification</td><td>TBD</td><td>TBD</td><td><span class="badge badge-amber">‚ö†Ô∏è Dates TBD</span></td></tr>
                            <tr style="background:rgba(245,158,11,0.15)"><td>Juan Medina</td><td>Composite Repair</td><td>Lincoln, NE</td><td>TBD</td><td><span class="badge badge-amber">‚ö†Ô∏è Dates TBD</span></td></tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#451a03;padding:10px;border-radius:6px;margin-top:10px;font-size:0.9em;color:#fef3c7;">
                    <strong>‚ö†Ô∏è Action Required:</strong> Contact Cassie/PDT to schedule dates for Julia, Ken, John, and Juan. (Michael Hannas on hold due to medical leave.)
                </div>
            </div>
        </div>
        
        <!-- QUALITY TAB -->
        <div class="content" id="quality">
            <!-- JANUARY 2026 AUDIT RESULTS -->
            <div class="card" style="border:2px solid #ef4444;">
                <div class="card-header">
                    <span class="card-title">üî¥ January 2026 AFL Audit Results</span>
                    <span class="badge badge-red">5 Findings</span>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;margin-bottom:15px;">
                    <div style="background:#1e293b;padding:12px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.85em;">Audit Date</div>
                        <div style="color:#60a5fa;font-size:1.3em;font-weight:bold;">Jan 21, 2026</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:8px;text-align:center;">
                        <div style="color:#94a3b8;font-size:0.85em;">Auditor</div>
                        <div style="color:#e2e8f0;font-size:1.1em;font-weight:bold;">Chris Demarest</div>
                    </div>
                    <div style="background:rgba(239,68,68,0.2);padding:12px;border-radius:8px;text-align:center;border:1px solid #ef4444;">
                        <div style="color:#fca5a5;font-size:0.85em;">Findings</div>
                        <div style="color:#ef4444;font-size:1.8em;font-weight:bold;">5</div>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Item</th><th>Issue</th><th>WO#</th><th>Details</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(251,191,36,0.2);">
                                <td style="color:#fbbf24;font-weight:bold;">1.1 + 1.10</td>
                                <td>Flame Locker Checklist</td>
                                <td>-</td>
                                <td>In/Out checklist incomplete - <span style="color:#fbbf24;font-weight:bold;">‚ö†Ô∏è REPEAT from Dec 2025</span></td>
                                <td><span class="badge badge-red">Open</span></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold;">2.9</td>
                                <td>Parts Segregation</td>
                                <td style="color:#60a5fa;">CTQMA</td>
                                <td>Unserviceable hoses mixed with serviceable parts, not tagged</td>
                                <td><span class="badge badge-red">Open</span></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold;">1.3</td>
                                <td>Parts Storage</td>
                                <td style="color:#60a5fa;">CTQMA</td>
                                <td>Vendor parts in blue bin piled up, not documented in WO</td>
                                <td><span class="badge badge-red">Open</span></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold;">1.4</td>
                                <td>Work Area Cleanliness</td>
                                <td>-</td>
                                <td>Heat shrink scraps left on work table</td>
                                <td><span class="badge badge-red">Open</span></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold;">1.3</td>
                                <td>Parts Tagging</td>
                                <td style="color:#60a5fa;">CU0VA</td>
                                <td>Panels in unmarked cart, not tagged, not in AS400 removal tab</td>
                                <td><span class="badge badge-red">Open</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:rgba(251,191,36,0.15);padding:10px;border-radius:6px;margin-top:10px;border:1px solid #fbbf24;">
                    <strong style="color:#fbbf24;">‚ö†Ô∏è REPEAT FINDING:</strong> <span style="color:#fef3c7;">Flame locker In/Out checklist was cited in Dec 2025 audit. Work was started but abandoned. This is a compliance priority.</span>
                </div>
            </div>
            
            <!-- CORRECTIVE ACTION TRACKER -->
            <div class="card" style="border:2px solid #f59e0b;">
                <div class="card-header">
                    <span class="card-title">üìã Corrective Action Tracker - January 2026 Audit</span>
                    <span class="badge badge-amber">0/5 Closed</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Finding</th><th>Corrective Action</th><th>Owner</th><th>Due Date</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(251,191,36,0.15);">
                                <td style="color:#fbbf24;font-weight:bold;">1.1/1.10 REPEAT</td>
                                <td>Complete flame locker In/Out checklist implementation. Train all techs on procedure.</td>
                                <td>Edduyn</td>
                                <td style="color:#ef4444;">Feb 7</td>
                                <td><span class="badge badge-amber">In Progress</span></td>
                            </tr>
                            <tr>
                                <td>2.9 Parts Segregation</td>
                                <td>Create designated unserviceable parts area. Retrain team on RSGOM PP-14.</td>
                                <td>Jose</td>
                                <td>Feb 14</td>
                                <td><span class="badge badge-red">Not Started</span></td>
                            </tr>
                            <tr>
                                <td>1.3 Parts Storage</td>
                                <td>Update CTQMA work order with vendor parts. Implement parts documentation SOP.</td>
                                <td>John Watson</td>
                                <td>Feb 7</td>
                                <td><span class="badge badge-red">Not Started</span></td>
                            </tr>
                            <tr>
                                <td>1.4 Work Area</td>
                                <td>Implement end-of-shift cleanup checklist. Daily walk-through before close.</td>
                                <td>Ken</td>
                                <td>Feb 7</td>
                                <td><span class="badge badge-red">Not Started</span></td>
                            </tr>
                            <tr>
                                <td>1.3 Parts Tagging</td>
                                <td>Update CU0VA with panel removals in AS400. Retrain on parts tagging requirements.</td>
                                <td>Jose</td>
                                <td>Feb 7</td>
                                <td><span class="badge badge-red">Not Started</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#94a3b8;">
                    üìß <strong>Report to:</strong> Chris Demarest (Audit Dept) | <strong>Next audit:</strong> ~Feb/Mar 2026 | <strong>Goal:</strong> Close all findings before next audit
                </div>
            </div>
            
            <!-- 2026 YTD SUMMARY -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Goal #7: 2026 Audit Performance</span>
                    <span class="badge badge-red">5 Findings YTD</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value" style="color:#ef4444">0%</div>
                        <div class="metric-label">Clean Audits</div>
                        <div class="metric-sub">2026 YTD (0/1)</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#ef4444">5</div>
                        <div class="metric-label">Total Findings</div>
                        <div class="metric-sub">2026 YTD</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#fbbf24">1</div>
                        <div class="metric-label">Repeat Findings</div>
                        <div class="metric-sub">From Dec 2025</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" style="color:#ef4444">0</div>
                        <div class="metric-label">Closed</div>
                        <div class="metric-sub">Corrective Actions</div>
                    </div>
                </div>
            </div>
            
            <!-- 2025 REFERENCE DATA -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìä 2025 Reference Data</span>
                    <span class="badge badge-gray">Historical</span>
                </div>
                <div class="card-grid">
                    <div class="metric">
                        <div class="metric-value">43%</div>
                        <div class="metric-label">Clean Audits (3/7)</div>
                        <div class="metric-sub">2025 QI Audits</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">50%</div>
                        <div class="metric-label">Clean Months (6/12)</div>
                        <div class="metric-sub">2025 Tech Discrepancies</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">16</div>
                        <div class="metric-label">Audit Findings</div>
                        <div class="metric-sub">2025 Total</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">34</div>
                        <div class="metric-label">Tech Discrepancies</div>
                        <div class="metric-sub">2025 Total</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Recurring Issues to Address</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Issue</th><th>Occurrences</th><th>Action</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(239,68,68,0.15);"><td style="color:#ef4444;font-weight:bold;">‚ö†Ô∏è Flammable Locker Control</td><td style="color:#ef4444;">3 + Jan 2026</td><td>PRIORITY - Complete In/Out checklist</td></tr>
                            <tr style="background:rgba(239,68,68,0.15);"><td style="color:#ef4444;font-weight:bold;">‚ö†Ô∏è Parts Traceability/Tagging</td><td style="color:#ef4444;">5 + Jan 2026</td><td>PRIORITY - Retrain team on RSGOM PP-13/14</td></tr>
                            <tr><td>Tool Control</td><td>2</td><td>Audit before QI visits</td></tr>
                            <tr><td>RTS/Paperwork</td><td>12</td><td>Tech training on documentation</td></tr>
                            <tr><td>Work Authorization</td><td>11</td><td>Verify signatures before work</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Top Offenders (2025 Tech Discrepancies)</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Tech</th><th>Count</th><th>Focus Area</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Ken Smith (SMIKZ)</td><td>13</td><td>Documentation + RTS</td></tr>
                            <tr><td>Armando (CRUZA)</td><td>6</td><td>Work Auth</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- WIP TAB -->
        <div class="content" id="wip">
            <!-- THE BIG NUMBER -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üí∞ January 2026 WIP</span>
                    <span class="badge badge-green">Correct Methodology</span>
                </div>
                
                <div style="text-align:center;padding:30px;background:linear-gradient(135deg,#064e3b,#065f46);border-radius:12px;margin-bottom:20px;">
                    <div style="color:#6ee7b7;font-size:1em;margin-bottom:5px;">JANUARY WIP (WOs opened this month, still open)</div>
                    <div style="font-size:3.5em;font-weight:bold;color:#10b981;">$26,036</div>
                    <div style="color:#a7f3d0;font-size:1.1em;margin-top:10px;">203.3 hours √ó WIP rates | 33 WOs</div>
                </div>
                
                <div style="background:#0f172a;padding:15px;border-radius:8px;border-left:4px solid #10b981;">
                    <div style="font-size:1.1em;font-weight:bold;color:#10b981;margin-bottom:8px;">‚úÖ WIP Methodology (Correct)</div>
                    <div style="color:#e2e8f0;line-height:1.6;">
                        <strong>Current Month WIP</strong> = Hours on WOs <u>opened this month</u> that are still open.<br>
                        <strong>Prior Month WOs</strong> = Already WIP'd when they opened. NOT included again.<br>
                        <strong>Billed Same Month</strong> = No WIP impact (becomes revenue directly).
                    </div>
                </div>
            </div>
            
            <!-- SDV SPECIAL WIP - EMAIL TO MATT -->
            <div class="card" style="border:2px solid #f59e0b;">
                <div class="card-header">
                    <span class="card-title">üìß SDV Special WIP List - FOR MATT</span>
                    <span class="badge badge-green">‚úÖ VERIFIED from Anchor 01/27/26</span>
                </div>
                <div style="background:#14532d;padding:12px;border-radius:8px;margin-bottom:15px;">
                    <strong style="color:#4ade80;">‚úÖ DATA VERIFIED:</strong>
                    <span style="color:#bbf7d0;">Cross-referenced Time Sold √ó Anchor (open) √ó Billed (excluded). Only 1 SDV WO with >10h is currently OPEN.</span>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;margin-bottom:15px;">
                    <div style="background:#1e293b;padding:12px;border-radius:8px;">
                        <div style="color:#94a3b8;font-size:0.85em;">SDV Special WIP Rate</div>
                        <div style="color:#fbbf24;font-size:1.5em;font-weight:bold;">$70/hr</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:8px;">
                        <div style="color:#94a3b8;font-size:0.85em;">SDV Margin</div>
                        <div style="color:#fbbf24;font-size:1.5em;font-weight:bold;">15%</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:8px;">
                        <div style="color:#94a3b8;font-size:0.85em;">Threshold</div>
                        <div style="color:#fbbf24;font-size:1.5em;font-weight:bold;">>10 hrs</div>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>WO#</th><th>Customer</th><th>Hours</th><th>WIP @ $70</th><th>Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr style="background:rgba(147,51,234,0.15)"><td>DB1UA üìç</td><td>Hogs Head Air 1 LLC</td><td>75.0h</td><td style="color:#a855f7;font-weight:bold">$5,250</td><td style="color:#a855f7;font-size:0.8em;">NJ shop - Juan loaned</td></tr>
                            <tr style="background:rgba(251,191,36,0.2);font-weight:bold;">
                                <td colspan="2">TOTAL SDV SPECIAL WIP (>10h, OPEN only)</td>
                                <td>75.0h</td>
                                <td style="color:#fbbf24;">$5,250</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:rgba(100,116,139,0.2);padding:10px;border-radius:6px;margin-top:10px;border:1px solid #64748b;">
                    <strong style="color:#94a3b8;">üìã EXCLUDED (not in Anchor):</strong> <span style="color:#64748b;">DUXFA (16.0h/$1,120) - WO is closed/not in Anchor 01/27/26</span>
                </div>
                <div style="background:rgba(147,51,234,0.2);padding:10px;border-radius:6px;margin-top:10px;border:1px solid #a855f7;">
                    <strong style="color:#c4b5fd;">üìç DB1UA Note:</strong> <span style="color:#e2e8f0;">This is a NJ shop WO. Juan Medina sold hours while loaned out. Hours count toward Denver financials but we have no control over billing timing.</span>
                </div>
                <div style="background:#1e293b;padding:12px;border-radius:8px;margin-top:15px;">
                    <strong style="color:#60a5fa;">üìã Email Template for Matt:</strong>
                    <div style="color:#e2e8f0;font-size:0.9em;margin-top:8px;font-family:monospace;background:#0f172a;padding:10px;border-radius:4px;">
                        Subject: Denver SDV Special WIP - January 2026<br><br>
                        Matt, here are the SDV WOs with >10 hours for special WIP @ $70/hr, 15% margin:<br><br>
                        DB1UA: 75.0h = $5,250 (Hogs Head Air 1 LLC) *NJ shop - Juan loaned hours<br><br>
                        Total: 75.0h = $5,250<br><br>
                        *Note: DB1UA is NJ shop WO. Hours count toward Denver but billing is NJ controlled.
                    </div>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.8em;color:#94a3b8;">
                    <strong style="color:#4ade80;">ü§ñ SMART AUTO-DETECT LOGIC:</strong><br>
                    1Ô∏è‚É£ Time Sold (SDV) ‚Üí Get all SDV hours by WO<br>
                    2Ô∏è‚É£ Anchor report (01/27/26) ‚Üí Get OPEN WOs only (13 SDV WOs open)<br>
                    3Ô∏è‚É£ Filter >10 hours ‚Üí Only DB1UA qualifies<br>
                    4Ô∏è‚É£ Calculate @ $70/hr<br>
                    <span style="color:#4ade80;">‚úÖ Last verified: 01/28/26 from Anchor 01/27/26</span>
                </div>
            </div>
            
            <!-- MONTHLY VARIANCE CHECK -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìä Monthly WIP Variance Check</span>
                    <span class="badge badge-blue">Catch Manual Entry Errors</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Month</th><th>My Estimate</th><th>Official (AS400)</th><th>Variance</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Dec 2025</td><td>-</td><td>-$16,870</td><td>-</td><td><span class="badge badge-green">Baseline</span></td></tr>
                            <tr><td>Jan 2026</td><td>$44,320</td><td><em>Pending (Feb)</em></td><td>-</td><td><span class="badge badge-amber">Awaiting</span></td></tr>
                            <tr><td>Feb 2026</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#1e293b;padding:12px;border-radius:8px;margin-top:15px;">
                    <strong style="color:#60a5fa;">üìã Monthly Check Process:</strong>
                    <div style="color:#e2e8f0;font-size:0.9em;margin-top:8px;">
                        1. Pull AS400 account 0889.35015 after month-end close (~2nd week)<br>
                        2. Compare to my estimate from end of that month<br>
                        3. Variance &gt;10% = investigate for typos or missed WOs<br>
                        4. Update this table to track accuracy over time
                    </div>
                </div>
            </div>
            
            <!-- WIP BY SHOP -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">WIP by Shop</span>
                    <span class="badge badge-blue">SDV @ $70 | Others @ $145</span>
                </div>
                
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-bottom:15px;">
                    <div style="background:linear-gradient(135deg,#1e40af,#3b82f6);padding:20px;border-radius:12px;text-align:center;">
                        <div style="font-size:0.85em;color:#bfdbfe;">SDN (Line Avionics)</div>
                        <div style="font-size:2em;font-weight:bold;color:white;">$17,893</div>
                        <div style="font-size:0.85em;color:#93c5fd;">123.4h √ó $145</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#854d0e,#ca8a04);padding:20px;border-radius:12px;text-align:center;border:2px solid #fbbf24;">
                        <div style="font-size:0.85em;color:#fef3c7;">SDV (Install) ‚≠ê SPECIAL</div>
                        <div style="font-size:2em;font-weight:bold;color:white;">$6,055</div>
                        <div style="font-size:0.85em;color:#fde68a;">86.5h √ó $70</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#c2410c,#f97316);padding:20px;border-radius:12px;text-align:center;">
                        <div style="font-size:0.85em;color:#fed7aa;">SDR (Recip)</div>
                        <div style="font-size:2em;font-weight:bold;color:white;">$9,498</div>
                        <div style="font-size:0.85em;color:#fdba74;">65.5h √ó $145</div>
                    </div>
                </div>
                <div style="background:#1e293b;padding:10px;border-radius:6px;font-size:0.85em;color:#e2e8f0;">
                    <strong style="color:#fbbf24;">‚≠ê SDV Special WIP:</strong> $70/hr rate, 15% margin. Email list to Matt last week of month for WOs >10 hours.
                </div>
            </div>
            
            <!-- TOP WIP WOs -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìã Top 10 WOs by WIP Value</span>
                    <span class="badge badge-green">Bill these ‚Üí Get revenue</span>
                </div>
                <div style="background:#14532d;padding:10px;border-radius:6px;margin-bottom:15px;font-size:0.85em;color:#bbf7d0;">
                    <strong style="color:#4ade80;">ü§ñ SMART AUTO-DETECT:</strong> Cross-references Time Sold √ó Anchor (OPEN) √ó Billed (excluded). Updates when new reports uploaded.
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>WO#</th><th>Shop</th><th>Customer</th><th>Hours</th><th>Rate</th><th style="color:#10b981">WIP $</th><th>Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>CTQMA</td><td>SDR</td><td>Robert P Husted</td><td>43.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$6,308</td><td style="color:#f59e0b;font-size:0.75em;">‚ö†Ô∏è Cited in audit</td></tr>
                            <tr style="background:rgba(147,51,234,0.15)"><td>DB1UA üìç</td><td>SDV</td><td>Hogs Head Air 1 LLC</td><td>75.0h</td><td style="color:#a855f7">$70</td><td style="color:#a855f7;font-weight:bold">$5,250</td><td style="color:#a855f7;font-size:0.75em;">NJ shop - Juan loaned</td></tr>
                            <tr><td>CU1EA</td><td>SDN</td><td>42K Re Management LLC</td><td>35.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$5,148</td><td></td></tr>
                            <tr style="background:rgba(16,185,129,0.25)"><td>CU16A ‚úÖ</td><td>SDN</td><td>Flying Orchard LLC</td><td>30.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$4,422</td><td style="color:#10b981;font-size:0.75em;">Billing this week</td></tr>
                            <tr><td>CU0VA</td><td>SDR</td><td>The Club at Centennial</td><td>21.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$3,118</td><td style="color:#f59e0b;font-size:0.75em;">‚ö†Ô∏è Cited in audit</td></tr>
                            <tr><td>CUPFA</td><td>SDN</td><td>Flying Orchard LLC</td><td>15.9h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$2,306</td><td></td></tr>
                            <tr><td>CU92A</td><td>SDN</td><td>Robbins Aviation</td><td>15.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$2,175</td><td></td></tr>
                            <tr><td>CUL2A</td><td>SDR</td><td>Peregrine</td><td>12.5h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$1,812</td><td></td></tr>
                            <tr><td>CU97A</td><td>SDN</td><td>Circadian Aviation LLC</td><td>12.0h</td><td>$145</td><td style="color:#10b981;font-weight:bold">$1,740</td><td></td></tr>
                            <tr style="background:rgba(251,191,36,0.15)"><td>CV78A</td><td>SDV‚≠ê</td><td>Primus Capital</td><td>8.0h</td><td style="color:#fbbf24">$70</td><td style="color:#fbbf24;font-weight:bold">$560</td><td></td></tr>
                            <tr style="background:rgba(16,185,129,0.2);font-weight:bold;font-size:1.1em;">
                                <td colspan="5">TOTAL TOP 10 WIP</td>
                                <td style="color:#10b981;font-size:1.2em;">$32,838</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="background:#0f172a;padding:10px;border-radius:6px;margin-top:10px;font-size:0.8em;color:#94a3b8;">
                    <strong style="color:#4ade80;">ü§ñ AUTO-DETECT LOGIC:</strong><br>
                    1Ô∏è‚É£ Time Sold report ‚Üí Get all hours by WO<br>
                    2Ô∏è‚É£ Anchor report (01/27/26) ‚Üí Filter OPEN WOs only (71 WOs)<br>
                    3Ô∏è‚É£ Billed report ‚Üí EXCLUDE already billed WOs (41 WOs)<br>
                    4Ô∏è‚É£ Sort by WIP value ‚Üí Show top 10<br>
                    <span style="color:#4ade80;">‚úÖ Last verified: 01/28/26 | Excluded: CUS4A, DTBLA, DUL0A, DUXFA (not in Anchor - closed/billed)</span>
                </div>
                <div style="background:#1e293b;padding:10px;border-radius:6px;margin-top:10px;font-size:0.85em;color:#e2e8f0;">
                    <span style="color:#fbbf24;">‚≠ê SDV</span> = Special WIP @ $70/hr | <span style="color:#a855f7;">üìç NJ</span> = Loaned hours (no billing control) | <span style="color:#f59e0b;">‚ö†Ô∏è Audit</span> = Cited in Jan audit
                </div>
            </div>
            
            <!-- SIMPLE ACTION BOX -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">‚ö° Quick Actions</span>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                    <div style="background:rgba(16,185,129,0.15);padding:15px;border-radius:8px;border:1px solid #10b981;">
                        <div style="font-weight:bold;color:#10b981;margin-bottom:8px;">‚úÖ To Increase Revenue:</div>
                        <div style="color:#e2e8f0;font-size:0.9em;">
                            1. Review open WOs with high WIP<br>
                            2. Bill completed work ‚Üí WIP becomes revenue<br>
                            3. Push WOs stuck in "Part Ord" or "Tentative"
                        </div>
                    </div>
                    <div style="background:rgba(239,68,68,0.15);padding:15px;border-radius:8px;border:1px solid #ef4444;">
                        <div style="font-weight:bold;color:#ef4444;margin-bottom:8px;">‚ö†Ô∏è Watch Out For:</div>
                        <div style="color:#e2e8f0;font-size:0.9em;">
                            1. WOs over 30 days (notify BZ)<br>
                            2. Jobs running more hours than quoted<br>
                            3. Disputed/problem WOs eating labor
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- HOW WIP WORKS -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìù How WIP Works</span>
                </div>
                <div style="font-family:monospace;background:#0f172a;padding:20px;border-radius:8px;font-size:1em;line-height:1.8;">
                    <div style="color:#94a3b8;">WIP Calculation:</div>
                    <div style="margin-left:20px;">
                        <span style="color:#60a5fa;">Hours on open WO</span> √ó <span style="color:#f59e0b;">WIP Rate</span> = <span style="color:#10b981;">WIP Value</span>
                    </div>
                    <div style="margin-top:15px;color:#94a3b8;">Example (SDN):</div>
                    <div style="margin-left:20px;">
                        <span style="color:#60a5fa;">35.5 hours</span> √ó <span style="color:#f59e0b;">$145</span> = <span style="color:#10b981;">$5,148 WIP</span>
                    </div>
                    <div style="margin-top:10px;color:#94a3b8;">Example (SDV - Special):</div>
                    <div style="margin-left:20px;">
                        <span style="color:#60a5fa;">24.5 hours</span> √ó <span style="color:#fbbf24;">$70</span> = <span style="color:#fbbf24;">$1,715 WIP</span>
                    </div>
                    <div style="margin-top:15px;border-top:1px solid #334155;padding-top:15px;">
                        <span style="color:#94a3b8;">When WO bills ‚Üí </span><span style="color:#10b981;">WIP becomes Revenue ‚úì</span>
                    </div>
                </div>
                <div style="margin-top:15px;display:grid;grid-template-columns:repeat(4,1fr);gap:10px;text-align:center;">
                    <div style="background:#1e293b;padding:12px;border-radius:6px;">
                        <div style="color:#3b82f6;font-weight:bold;">SDN</div>
                        <div style="color:white;font-size:1.2em;">$145</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:6px;border:2px solid #fbbf24;">
                        <div style="color:#fbbf24;font-weight:bold;">SDV ‚≠ê</div>
                        <div style="color:#fbbf24;font-size:1.2em;">$70</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:6px;">
                        <div style="color:#f97316;font-weight:bold;">SDR</div>
                        <div style="color:white;font-size:1.2em;">$145</div>
                    </div>
                    <div style="background:#1e293b;padding:12px;border-radius:6px;">
                        <div style="color:#a855f7;font-weight:bold;">SHC</div>
                        <div style="color:white;font-size:1.2em;">$145</div>
                    </div>
                </div>
                <div style="margin-top:15px;background:#451a03;padding:10px;border-radius:6px;font-size:0.85em;color:#fef3c7;">
                    <strong style="color:#fbbf24;">‚≠ê SDV Special:</strong> $70/hr rate, 15% margin. Email WOs >10hrs to Matt last week of month. Exclude shop WO (DT39A).
                </div>
            </div>
        </div>
        
        <!-- RANKINGS TAB -->
        <div class="content" id="rankings">
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üèÜ Duncan Aviation Satellite Network - A/B Ratio Rankings</span>
                    <span class="badge badge-blue">Jan 23, 2026 (YTD)</span>
                </div>
                <p style="color:#94a3b8;margin-bottom:15px;font-size:0.9em;">
                    <strong>A/B Ratio</strong> = Actual Billable Hours √∑ Bought (Paid) Hours | Measures labor efficiency
                </p>
                <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:15px;">
                    <strong>Network Average:</strong> 48.0% | <strong>Budget Target:</strong> 58.7%
                </div>
                
                <div class="rank-item"><div class="rank-num">1</div><div class="rank-shop">Scottsdale</div><div class="rank-value" style="color:#10b981">77.7%</div></div>
                <div class="rank-item"><div class="rank-num">2</div><div class="rank-shop">Seattle</div><div class="rank-value" style="color:#10b981">74.7%</div></div>
                <div class="rank-item"><div class="rank-num">3</div><div class="rank-shop">Sacramento</div><div class="rank-value" style="color:#10b981">74.0%</div></div>
                <div class="rank-item"><div class="rank-num">4</div><div class="rank-shop">Portland</div><div class="rank-value" style="color:#10b981">72.1%</div></div>
                <div class="rank-item"><div class="rank-num">5</div><div class="rank-shop">St. Paul</div><div class="rank-value" style="color:#10b981">71.3%</div></div>
                <div class="rank-item"><div class="rank-num">6</div><div class="rank-shop">Ft. Lauderdale</div><div class="rank-value" style="color:#10b981">70.2%</div></div>
                <div class="rank-item"><div class="rank-num">7</div><div class="rank-shop">Las Vegas</div><div class="rank-value" style="color:#10b981">65.7%</div></div>
                <div class="rank-item"><div class="rank-num">8</div><div class="rank-shop">Boston</div><div class="rank-value" style="color:#10b981">65.0%</div></div>
                <div class="rank-item"><div class="rank-num">9</div><div class="rank-shop">Dallas</div><div class="rank-value" style="color:#10b981">62.1%</div></div>
                <div class="rank-item"><div class="rank-num">10</div><div class="rank-shop">Nashville</div><div class="rank-value" style="color:#10b981">62.1%</div></div>
                <div class="rank-item"><div class="rank-num">11</div><div class="rank-shop">Long Island</div><div class="rank-value" style="color:#f59e0b">57.1%</div></div>
                <div class="rank-item"><div class="rank-num">12</div><div class="rank-shop">Oxford</div><div class="rank-value" style="color:#f59e0b">57.0%</div></div>
                <div class="rank-item"><div class="rank-num">13</div><div class="rank-shop">Teterboro</div><div class="rank-value" style="color:#f59e0b">55.8%</div></div>
                <div class="rank-item"><div class="rank-num">14</div><div class="rank-shop">Manassas</div><div class="rank-value" style="color:#f59e0b">51.8%</div></div>
                <div class="rank-item"><div class="rank-num">15</div><div class="rank-shop">Atlanta</div><div class="rank-value" style="color:#f59e0b">47.9%</div></div>
                <div class="rank-item"><div class="rank-num">16</div><div class="rank-shop">Van Nuys</div><div class="rank-value" style="color:#f59e0b">46.5%</div></div>
                <div class="rank-item"><div class="rank-num">17</div><div class="rank-shop">Austin</div><div class="rank-value" style="color:#ef4444">37.4%</div></div>
                <div class="rank-item"><div class="rank-num">18</div><div class="rank-shop">St. Louis</div><div class="rank-value" style="color:#ef4444">28.2%</div></div>
                <div class="rank-item"><div class="rank-num">19</div><div class="rank-shop">Kansas City</div><div class="rank-value" style="color:#ef4444">27.7%</div></div>
                <div class="rank-item denver"><div class="rank-num" style="background:#ef4444;color:#fff">20</div><div class="rank-shop"><strong>DENVER</strong></div><div class="rank-value" style="color:#ef4444">25.0%</div></div>
                <div class="rank-item"><div class="rank-num">21</div><div class="rank-shop">Houston</div><div class="rank-value" style="color:#ef4444">14.3%</div></div>
            </div>
        </div>
    </div>
    
    <script>
        const PASSWORD = 'denver889';
        let isRotating = false;
        let isPaused = false;
        let rotateInterval;
        let scrollInterval;
        let pauseTimeout;
        let currentTab = 0;
        const tabs = ['goals', 'actions', 'overview', 'employees', 'workorders', 'training', 'quality', 'wip', 'rankings'];
        
        // Auto-refresh every 10 minutes
        setTimeout(() => location.reload(), 600000);
        
        function login() {
            const pwd = document.getElementById('passwordInput').value;
            if (pwd === PASSWORD) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                localStorage.setItem('denver_auth', 'true');
                showTab(tabs[0]); // Show first tab
                tryFullscreen();
                startAutoRotate();
            } else {
                document.getElementById('errorMsg').style.display = 'block';
            }
        }
        
        function logout() {
            localStorage.removeItem('denver_auth');
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('passwordInput').value = '';
            stopAutoRotate();
        }
        
        function tryFullscreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen().catch(()=>{});
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) tryFullscreen();
            else if (document.exitFullscreen) document.exitFullscreen();
        }
        
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
        
        // Alias for compatibility
        const showTab = switchTab;
        
        function startAutoRotate() {
            isRotating = true;
            isPaused = false;
            document.getElementById('rotateBtn').textContent = '‚è∏Ô∏è Stop';
            document.getElementById('rotateBtn').style.background = '#ef4444';
            updateStatus();
            startSmoothScroll();
        }
        
        function stopAutoRotate() {
            isRotating = false;
            isPaused = false;
            clearInterval(scrollInterval);
            clearTimeout(pauseTimeout);
            document.getElementById('rotateBtn').textContent = '‚ñ∂Ô∏è Auto';
            document.getElementById('rotateBtn').style.background = '#10b981';
            document.getElementById('statusIndicator').textContent = 'Ready';
            document.getElementById('statusIndicator').className = 'status-indicator';
        }
        
        function toggleRotate() {
            if (isRotating) stopAutoRotate();
            else startAutoRotate();
        }
        
        function updateStatus() {
            const indicator = document.getElementById('statusIndicator');
            if (isPaused) {
                indicator.textContent = 'PAUSED - Tap to resume';
                indicator.className = 'status-indicator status-paused';
            } else if (isRotating) {
                indicator.textContent = 'Display Mode';
                indicator.className = 'status-indicator status-active';
            }
        }
        
        function startSmoothScroll() {
            let scrollPos = 0;
            let scrollDir = 1;
            let tabTime = 0;
            const tabDuration = 23000; // 23 sec per tab (15% slower)
            const scrollSpeed = 2;
            
            clearInterval(scrollInterval);
            scrollInterval = setInterval(() => {
                if (isPaused) return;
                
                tabTime += 50;
                
                // Smooth scroll
                const content = document.getElementById(tabs[currentTab]);
                if (content) {
                    const maxScroll = content.scrollHeight - window.innerHeight + 200;
                    scrollPos += scrollDir * scrollSpeed;
                    if (scrollPos >= maxScroll) { scrollPos = maxScroll; scrollDir = -1; }
                    if (scrollPos <= 0) { scrollPos = 0; scrollDir = 1; }
                    window.scrollTo({top: scrollPos});
                }
                
                // Change tabs
                if (tabTime >= tabDuration) {
                    tabTime = 0;
                    scrollPos = 0;
                    scrollDir = 1;
                    currentTab = (currentTab + 1) % tabs.length;
                    showTab(tabs[currentTab]);
                }
            }, 50);
        }
        
        function pauseScroll() {
            if (!isRotating) return;
            isPaused = true;
            updateStatus();
            clearTimeout(pauseTimeout);
            pauseTimeout = setTimeout(() => {
                isPaused = false;
                updateStatus();
            }, 34500);
        }
        
        function resumeScroll() {
            isPaused = false;
            clearTimeout(pauseTimeout);
            updateStatus();
        }
        
        // Tab click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;
                showTab(tabId);
                if (isRotating) {
                    currentTab = tabs.indexOf(tabId);
                    pauseScroll();
                }
            });
        });
        
        // Pause on interaction
        document.addEventListener('click', pauseScroll);
        document.addEventListener('touchstart', pauseScroll);
        
        // Check for saved auth
        if (localStorage.getItem('denver_auth') === 'true') {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            showTab(tabs[0]); // Show first tab
            startAutoRotate();
        }
        
        // NPS One-Click Email System with Tracking
        const npsEmailParts = ['ths', 'masd.metrea.aero'];
        const npsEmail = npsEmailParts.join('@');
        
        // Populate peregrine email in table
        const peregineEmailEl = document.getElementById('peregrine-email');
        if (peregineEmailEl) peregineEmailEl.textContent = npsEmail;
        
        // NPS Tracking - HARDCODED DATA (persists across file reloads)
        // Claude updates this array when you report new surveys sent
        let npsSurveyData = [
            {date: '01/28/26', customer: 'Peregrine', email: 'ths@masd.metrea.aero', wo: 'DTBLA', regNum: '', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Bode Aviation', email: 'michelle.amezcua@flybode.com', wo: 'DSW5A', regNum: 'N328SF', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'MIMG Transportation', email: 'n950kmmx@gmail.com', wo: 'CV3UA', regNum: 'STOCK', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Infinity Energia', email: 'EDUARDO@INFINITYENERGIAD.COM.BR', wo: 'CUGZA', regNum: 'PR-BBD', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Liberty Global', email: 'apdenver@libertyglobal.com', wo: 'CT8VA', regNum: 'N250LG', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'M&N Aviation', email: 'accounting@mandn.aero', wo: 'CT0VA', regNum: 'N488RJ', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Arapahoe Aero', email: 'customercare@arapahoeaero.com', wo: 'CSAZA', regNum: 'N426LM', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'GMR', email: 'parts-mtc@gmr.net', wo: 'CU44A', regNum: 'N866MB', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Aspen Flying Club', email: 'accounting@aspenflyingclub.com', wo: 'CS1XA', regNum: 'N331JK', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Flights Inc', email: 'ABAUER@FLIGHTS-INC.COM', wo: 'CRW3A', regNum: 'N22265', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Civil Air Patrol', email: 'capconsmx@capnhq.gov', wo: 'CSYNA', regNum: 'N846CP', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'AirMax', email: 'rong@airmaxonline.com', wo: 'CUCJA', regNum: 'N137ZM', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'International Jet Aviation', email: 'heike@internationaljet.com', wo: 'CUX4A', regNum: 'N219JG', status: 'Sent', score: null},
            {date: '01/28/26', customer: 'Pilot Service Provider', email: 'scott.j@pilotserviceprovider.com', wo: 'CQCAB', regNum: 'N750JE', status: 'Sent', score: null}
        ];
        
        function getNpsSurveys() {
            return npsSurveyData;
        }
        
        function saveNpsSurveys(surveys) {
            npsSurveyData = surveys;
            // Note: Changes during session are temporary. Tell Claude to add permanent entries.
        }
        
        // Smart Fill function for NPS form
        function fillNps(name, email, wo, reg) {
            document.getElementById('npsCustomerName').value = name;
            document.getElementById('npsCustomerEmail').value = email;
            document.getElementById('npsWO').value = wo;
            document.getElementById('npsRegNumber').value = reg || '';
            // Scroll to form
            document.getElementById('npsCustomerName').scrollIntoView({behavior: 'smooth', block: 'center'});
        }
        
        function updateNpsStats() {
            const surveys = getNpsSurveys();
            const sent = surveys.length;
            const completed = surveys.filter(s => s.status === 'Completed').length;
            const pending = surveys.filter(s => s.status === 'Sent').length;
            const rate = sent > 0 ? Math.round((completed / sent) * 100) + '%' : '-';
            const billedWOsTarget = 41;  // Total billed WOs in January (update with new Billed WO report)
            
            document.getElementById('statSent').textContent = sent + '/' + billedWOsTarget;
            document.getElementById('statCompleted').textContent = completed;
            document.getElementById('statPending').textContent = pending;
            document.getElementById('statRate').textContent = rate;
            
            // Update badge
            const badge = document.getElementById('npsBadge');
            if (completed >= 1) {
                badge.textContent = `Jan: ${completed}/1 ‚úÖ`;
                badge.style.background = '#10b981';
            } else if (sent > 0) {
                badge.textContent = `Jan: ${completed}/1 ‚è≥`;
                badge.style.background = '#f59e0b';
            } else {
                badge.textContent = 'Jan: 0/1 ‚ö†Ô∏è';
                badge.style.background = '#ef4444';
            }
            
            // UPDATE GOAL #2 PROGRESS BARS (Smart sync)
            const yearlyTarget = 12;  // Monthly goal: 1/month = 12/year
            
            const completedPct = Math.round((completed / yearlyTarget) * 100);
            const sentPct = Math.round((sent / billedWOsTarget) * 100);
            
            // Update completed bar (vs yearly target)
            document.getElementById('npsCompletedBar').style.width = Math.min(completedPct, 100) + '%';
            document.getElementById('npsCompletedCount').textContent = completed + ' / ' + yearlyTarget;
            
            // Update sent bar (vs billed WOs)
            document.getElementById('npsSentBar').style.width = Math.min(sentPct, 100) + '%';
            document.getElementById('npsSentCount').textContent = sent + ' / ' + billedWOsTarget;
            
            // Update goal percentage and badge
            const goalPct = document.getElementById('npsGoalPct');
            const goalBadge = document.getElementById('npsGoalBadge');
            goalPct.textContent = completedPct + '%';
            
            if (completed >= 1) {
                goalPct.style.color = '#10b981';
                goalBadge.textContent = 'On Track';
                goalBadge.className = 'badge badge-green';
            } else if (sent > 0) {
                goalPct.style.color = '#f59e0b';
                goalBadge.textContent = 'Sent - Awaiting';
                goalBadge.className = 'badge badge-amber';
            } else {
                goalPct.style.color = '#ef4444';
                goalBadge.textContent = 'Action Needed!';
                goalBadge.className = 'badge badge-red';
            }
            
            // Update summary text
            document.getElementById('npsGoalSummary').textContent = 'Target: 1/month (12/yr) | Sent vs Billed WOs: ' + sent + '/' + billedWOsTarget + ' (' + sentPct + '%)';
        }
        
        function renderNpsTable() {
            const surveys = getNpsSurveys();
            const tbody = document.getElementById('npsTrackingBody');
            
            if (surveys.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="color:#64748b;text-align:center;">No surveys logged yet</td></tr>';
                return;
            }
            
            tbody.innerHTML = surveys.map((s, idx) => `
                <tr style="background:${s.status === 'Completed' ? 'rgba(16,185,129,0.2)' : s.status === 'No Response' ? 'rgba(239,68,68,0.2)' : 'rgba(251,191,36,0.2)'}">
                    <td>${s.date}</td>
                    <td>${s.customer}</td>
                    <td>${s.wo || '-'}</td>
                    <td><span style="color:${s.status === 'Completed' ? '#10b981' : s.status === 'No Response' ? '#ef4444' : '#f59e0b'}">${s.status}</span></td>
                    <td>${s.score || '-'}</td>
                    <td>
                        ${s.status === 'Sent' ? `
                            <button onclick="completeNpsSurvey(${idx})" style="background:#10b981;color:white;border:none;padding:2px 6px;border-radius:3px;font-size:0.75em;cursor:pointer;margin-right:3px;">‚úì</button>
                            <button onclick="noResponseNpsSurvey(${idx})" style="background:#ef4444;color:white;border:none;padding:2px 6px;border-radius:3px;font-size:0.75em;cursor:pointer;">‚úó</button>
                        ` : ''}
                    </td>
                </tr>
            `).join('');
            
            updateNpsStats();
        }
        
        function logNpsSurvey(openOutlook = false) {
            const customerName = document.getElementById('npsCustomerName').value.trim();
            const email = document.getElementById('npsCustomerEmail').value.trim();
            const wo = document.getElementById('npsWO').value.trim().toUpperCase();
            const regNum = document.getElementById('npsRegNumber').value.trim().toUpperCase();
            const errorDiv = document.getElementById('npsError');
            const successDiv = document.getElementById('npsSuccess');
            
            // Validate - customer name, email, and WO are required
            if (!customerName || !email || !wo) {
                errorDiv.textContent = '‚ö†Ô∏è Please enter customer name, email, and WO#';
                errorDiv.style.display = 'block';
                successDiv.style.display = 'none';
                return false;
            }
            errorDiv.style.display = 'none';
            
            // Log to storage
            const surveys = getNpsSurveys();
            const today = new Date();
            const dateStr = `${String(today.getMonth()+1).padStart(2,'0')}/${String(today.getDate()).padStart(2,'0')}/${String(today.getFullYear()).slice(-2)}`;
            
            surveys.push({
                date: dateStr,
                customer: customerName,
                email: email,
                wo: wo,
                regNum: regNum,
                status: 'Sent',
                score: null
            });
            
            saveNpsSurveys(surveys);
            renderNpsTable();
            renderCustomerTable();
            
            // Show success
            successDiv.style.display = 'block';
            setTimeout(() => successDiv.style.display = 'none', 2000);
            
            // Clear form
            document.getElementById('npsCustomerName').value = '';
            document.getElementById('npsCustomerEmail').value = '';
            document.getElementById('npsWO').value = '';
            document.getElementById('npsRegNumber').value = '';
            
            // Open Outlook if requested
            if (openOutlook) {
                let subject, body;
                const surveyUrl = 'https://form.jotform.com/231574976012155';
                
                if (regNum) {
                    subject = `Quick Feedback Request - ${regNum} Service`;
                    body = `Hi,

Thank you for choosing Duncan Aviation Denver for your recent service on ${regNum}.

Help us make improvements to our service by filling out a quick 8 questions survey for the Denver Satellite Shop. Please leave feedback by clicking on the link below. Include your phone number in the comments to be added to the monthly prize raffle.

Best Regards,

${surveyUrl}`;
                } else {
                    subject = `Quick Feedback Request - WO# ${wo}`;
                    body = `Hi,

Thank you for choosing Duncan Aviation Denver for your recent service.

Help us make improvements to our service by filling out a quick 8 questions survey for the Denver Satellite Shop. Please leave feedback by clicking on the link below. Include your phone number in the comments to be added to the monthly prize raffle.

Best Regards,

${surveyUrl}`;
                }
                const outlookUrl = `https://outlook.office365.com/mail/deeplink/compose?to=${email}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.open(outlookUrl, '_blank');
            }
            
            return true;
        }
        
        window.completeNpsSurvey = function(idx) {
            const score = prompt('Enter NPS Score (0-10):');
            if (score === null) return;
            const scoreNum = parseInt(score);
            if (isNaN(scoreNum) || scoreNum < 0 || scoreNum > 10) {
                alert('Please enter a valid score between 0 and 10');
                return;
            }
            const surveys = getNpsSurveys();
            surveys[idx].status = 'Completed';
            surveys[idx].score = scoreNum;
            saveNpsSurveys(surveys);
            renderNpsTable();
        };
        
        window.noResponseNpsSurvey = function(idx) {
            if (!confirm('Mark as No Response?')) return;
            const surveys = getNpsSurveys();
            surveys[idx].status = 'No Response';
            saveNpsSurveys(surveys);
            renderNpsTable();
        };
        
        // Send & Log button
        const sendBtn = document.getElementById('sendNpsSurveyBtn');
        if (sendBtn) {
            sendBtn.onclick = function(e) {
                e.stopPropagation();
                logNpsSurvey(true); // true = open Outlook
            };
        }
        
        // Log Only button
        const logOnlyBtn = document.getElementById('logOnlyBtn');
        if (logOnlyBtn) {
            logOnlyBtn.onclick = function(e) {
                e.stopPropagation();
                logNpsSurvey(false); // false = don't open Outlook
            };
        }
        
        // Clear last entry button
        const clearLastBtn = document.getElementById('clearLastNps');
        if (clearLastBtn) {
            clearLastBtn.onclick = function(e) {
                e.stopPropagation();
                const surveys = getNpsSurveys();
                if (surveys.length === 0) {
                    alert('No entries to remove');
                    return;
                }
                const lastEntry = surveys[surveys.length - 1];
                if (confirm(`Remove last entry?\n\n${lastEntry.date} - ${lastEntry.customer} (${lastEntry.wo})`)) {
                    surveys.pop();
                    saveNpsSurveys(surveys);
                    renderNpsTable();
                    renderCustomerTable();
                    updateNpsStats();
                }
            };
        }
        
        // ==========================================
        // DYNAMIC CUSTOMER DATABASE SYSTEM
        // ==========================================
        
        // Default seed data (will be loaded into localStorage if empty)
        const defaultCustomers = [
            {name: 'Bode Aviation', email: 'michelle.amezcua@flybode.com', wo: 'DSW5A', reg: 'N328SF', revenue: 34270},
            {name: 'MIMG Transportation', email: 'n950kmmx@gmail.com', wo: 'CV3UA', reg: 'STOCK', revenue: 9297},
            {name: 'Peregrine', email: 'ths@masd.metrea.aero', wo: 'DTBLA', reg: '', revenue: 6856},
            {name: 'Infinity Energia', email: 'EDUARDO@INFINITYENERGIAD.COM.BR', wo: 'CUGZA', reg: 'PR-BBD', revenue: 5444},
            {name: 'Liberty Global', email: 'apdenver@libertyglobal.com', wo: 'CT8VA', reg: 'N250LG', revenue: 4445},
            {name: 'M&N Aviation', email: 'accounting@mandn.aero', wo: 'CT0VA', reg: 'N488RJ', revenue: 2475},
            {name: 'Arapahoe Aero', email: 'customercare@arapahoeaero.com', wo: 'CSAZA', reg: 'N426LM', revenue: 2118},
            {name: 'GMR', email: 'parts-mtc@gmr.net', wo: 'CU44A', reg: 'N866MB', revenue: 1942},
            {name: 'Aspen Flying Club', email: 'accounting@aspenflyingclub.com', wo: 'CS1XA', reg: 'N331JK', revenue: 1632},
            {name: 'Flights Inc', email: 'ABAUER@FLIGHTS-INC.COM', wo: 'CRW3A', reg: 'N22265', revenue: 1632},
            {name: 'Civil Air Patrol', email: 'capconsmx@capnhq.gov', wo: 'CSYNA', reg: 'N846CP', revenue: 1267},
            {name: 'AirMax', email: 'rong@airmaxonline.com', wo: 'CUCJA', reg: 'N137ZM', revenue: 785},
            {name: 'International Jet Aviation', email: 'heike@internationaljet.com', wo: 'CUX4A', reg: 'N219JG', revenue: 706},
            {name: 'Pilot Service Provider', email: 'scott.j@pilotserviceprovider.com', wo: 'CQCAB', reg: 'N750JE', revenue: 0}
        ];
        
        function getCustomerDatabase() {
            let db = localStorage.getItem('denver_nps_customers');
            if (!db) {
                // Initialize with default data
                localStorage.setItem('denver_nps_customers', JSON.stringify(defaultCustomers));
                return defaultCustomers;
            }
            return JSON.parse(db);
        }
        
        function saveCustomerDatabase(db) {
            localStorage.setItem('denver_nps_customers', JSON.stringify(db));
        }
        
        function addCustomerToDb() {
            const name = document.getElementById('newCustName').value.trim();
            const email = document.getElementById('newCustEmail').value.trim();
            const wo = document.getElementById('newCustWO').value.trim().toUpperCase();
            const reg = document.getElementById('newCustReg').value.trim().toUpperCase();
            const revenue = parseInt(document.getElementById('newCustRevenue').value) || 0;
            
            const msgEl = document.getElementById('addCustMsg');
            
            if (!name || !email || !wo) {
                msgEl.textContent = '‚ö†Ô∏è Name, Email, and WO# are required';
                msgEl.style.color = '#fca5a5';
                msgEl.style.display = 'block';
                setTimeout(() => msgEl.style.display = 'none', 3000);
                return;
            }
            
            const db = getCustomerDatabase();
            
            // Check for duplicate WO
            if (db.some(c => c.wo.toUpperCase() === wo)) {
                msgEl.textContent = '‚ö†Ô∏è WO# ' + wo + ' already exists in database';
                msgEl.style.color = '#fca5a5';
                msgEl.style.display = 'block';
                setTimeout(() => msgEl.style.display = 'none', 3000);
                return;
            }
            
            // Add new customer
            db.push({ name, email, wo, reg, revenue });
            
            // Sort by revenue descending
            db.sort((a, b) => b.revenue - a.revenue);
            
            saveCustomerDatabase(db);
            
            // Clear form
            document.getElementById('newCustName').value = '';
            document.getElementById('newCustEmail').value = '';
            document.getElementById('newCustWO').value = '';
            document.getElementById('newCustReg').value = '';
            document.getElementById('newCustRevenue').value = '';
            
            // Show success
            msgEl.textContent = '‚úÖ Added ' + name + ' (' + wo + ') - $' + revenue.toLocaleString();
            msgEl.style.color = '#86efac';
            msgEl.style.display = 'block';
            setTimeout(() => msgEl.style.display = 'none', 3000);
            
            // Refresh display
            renderCustomerTable();
            updateTopCandidate();
        }
        
        function removeCustomerFromDb(wo) {
            if (!confirm('Remove ' + wo + ' from database?')) return;
            
            let db = getCustomerDatabase();
            db = db.filter(c => c.wo.toUpperCase() !== wo.toUpperCase());
            saveCustomerDatabase(db);
            
            renderCustomerTable();
            updateTopCandidate();
        }
        
        function clearCustomerDb() {
            if (!confirm('Clear ALL customers from database? This cannot be undone.')) return;
            if (!confirm('Are you sure? This will remove all ' + getCustomerDatabase().length + ' customers.')) return;
            
            localStorage.removeItem('denver_nps_customers');
            renderCustomerTable();
            updateTopCandidate();
        }
        
        // Bulk import function - can be called from console
        // Usage: bulkAddCustomers([{name:'Test', email:'test@test.com', wo:'ABC123', reg:'N123', revenue:5000}])
        window.bulkAddCustomers = function(customers) {
            if (!Array.isArray(customers)) {
                console.error('bulkAddCustomers expects an array');
                return;
            }
            
            const db = getCustomerDatabase();
            let added = 0;
            let skipped = 0;
            
            customers.forEach(c => {
                if (!c.name || !c.email || !c.wo) {
                    console.warn('Skipping invalid customer:', c);
                    skipped++;
                    return;
                }
                
                const wo = c.wo.toUpperCase();
                if (db.some(existing => existing.wo.toUpperCase() === wo)) {
                    console.log('Skipping duplicate WO:', wo);
                    skipped++;
                    return;
                }
                
                db.push({
                    name: c.name,
                    email: c.email,
                    wo: wo,
                    reg: (c.reg || '').toUpperCase(),
                    revenue: parseInt(c.revenue) || 0
                });
                added++;
            });
            
            // Sort by revenue descending
            db.sort((a, b) => b.revenue - a.revenue);
            saveCustomerDatabase(db);
            
            renderCustomerTable();
            updateTopCandidate();
            
            console.log(`‚úÖ Bulk import complete: ${added} added, ${skipped} skipped. Total: ${db.length} customers.`);
            return { added, skipped, total: db.length };
        };
        
        // Export function to get current database
        window.exportCustomerDb = function() {
            return getCustomerDatabase();
        };
        
        function updateTopCandidate() {
            const surveys = getNpsSurveys();
            const sentWOs = surveys.map(s => s.wo.toUpperCase());
            const db = getCustomerDatabase();
            
            // Find highest revenue unsurveyed customer
            const unsurveyed = db.filter(c => !sentWOs.includes(c.wo.toUpperCase()));
            const container = document.getElementById('topCandidateContent');
            const section = document.getElementById('topCandidateSection');
            
            if (unsurveyed.length === 0) {
                section.style.background = '#14532d';
                container.innerHTML = '<div style="grid-column:span 4;color:#86efac;text-align:center;">‚úÖ All customers surveyed! Great job!</div>';
                return;
            }
            
            // Sort by revenue and get top
            unsurveyed.sort((a, b) => b.revenue - a.revenue);
            const top = unsurveyed[0];
            
            section.style.background = '#1e293b';
            container.innerHTML = `
                <div><span style="color:#64748b;">WO:</span> <span style="color:#fbbf24;">${top.wo}</span></div>
                <div><span style="color:#64748b;">Customer:</span> <span style="color:white;">${top.name}</span></div>
                <div><span style="color:#64748b;">Amount:</span> <span style="color:#10b981;">$${top.revenue.toLocaleString()}</span></div>
                <button onclick="fillNps('${top.name.replace(/'/g, "\\'")}','${top.email}','${top.wo}','${top.reg}')" style="background:#10b981;color:white;border:none;padding:8px 15px;border-radius:4px;font-size:0.9em;cursor:pointer;font-weight:bold;">‚úì Auto-Fill</button>
            `;
        }
        
        function renderCustomerTable() {
            const surveys = getNpsSurveys();
            const sentWOs = surveys.map(s => s.wo.toUpperCase());
            const showSent = document.getElementById('showSentCustomers').checked;
            const tbody = document.getElementById('customerDbBody');
            const summaryDiv = document.getElementById('npsDbSummary');
            
            const customerDatabase = getCustomerDatabase();
            
            let html = '';
            let notSentCount = 0;
            let sentCount = 0;
            
            customerDatabase.forEach(c => {
                const isSent = sentWOs.includes(c.wo.toUpperCase());
                if (isSent) sentCount++;
                else notSentCount++;
                
                if (!showSent && isSent) return; // Skip sent if checkbox unchecked
                
                const rowStyle = isSent ? 'background:rgba(107,114,128,0.3);opacity:0.7;' : (c.revenue > 5000 ? 'background:rgba(16,185,129,0.2);' : '');
                const woStyle = isSent ? 'color:#64748b;' : 'color:#60a5fa;font-weight:bold;';
                const revStyle = c.revenue === 0 ? 'color:#94a3b8;' : 'color:#10b981;';
                const regDisplay = c.reg || '-';
                const revDisplay = '$' + c.revenue.toLocaleString();
                
                let actionCell;
                if (isSent) {
                    actionCell = '<span style="color:#10b981;font-size:0.8em;">‚úì Sent</span>';
                } else {
                    const btnStyle = c.revenue > 0 ? 'background:#10b981;' : 'background:#475569;';
                    actionCell = `<button onclick="fillNps('${c.name.replace(/'/g, "\\'")}','${c.email}','${c.wo}','${c.reg}')" style="${btnStyle}color:white;border:none;padding:4px 10px;border-radius:4px;font-size:0.8em;cursor:pointer;">‚úì Use</button>`;
                }
                
                // Add delete button
                const deleteBtn = `<button onclick="removeCustomerFromDb('${c.wo}')" style="background:transparent;color:#64748b;border:none;padding:2px 5px;font-size:0.7em;cursor:pointer;margin-left:5px;" title="Remove">‚úï</button>`;
                
                html += `<tr style="${rowStyle}">
                    <td>${c.name}</td>
                    <td style="color:#fbbf24;font-family:monospace;font-size:0.8em;">${c.email}</td>
                    <td style="${woStyle}">${c.wo}</td>
                    <td style="color:#94a3b8;">${regDisplay}</td>
                    <td style="${revStyle}">${revDisplay}</td>
                    <td>${actionCell}${deleteBtn}</td>
                </tr>`;
            });
            
            if (html === '') {
                html = '<tr><td colspan="6" style="color:#64748b;text-align:center;">No customers in database. Add billed WOs above.</td></tr>';
            }
            
            tbody.innerHTML = html;
            
            // Update summary
            if (customerDatabase.length === 0) {
                summaryDiv.innerHTML = 'üìã Add billed WOs above to track NPS surveys.';
                summaryDiv.style.background = '#1e3a5f';
                summaryDiv.style.color = '#93c5fd';
            } else if (notSentCount === 0) {
                summaryDiv.innerHTML = '‚úÖ <strong>All ' + sentCount + ' surveys sent!</strong> Waiting for responses.';
                summaryDiv.style.background = '#14532d';
                summaryDiv.style.color = '#bbf7d0';
            } else {
                summaryDiv.innerHTML = 'üìã <strong>' + notSentCount + ' remaining</strong> | ' + sentCount + ' sent. Click "‚úì Use" to auto-fill form.';
                summaryDiv.style.background = '#1e3a5f';
                summaryDiv.style.color = '#93c5fd';
            }
            
            // Update count in header
            document.getElementById('customerDbCount').textContent = customerDatabase.length;
        }
        
        // Initialize tracking table and customer table
        renderNpsTable();
        renderCustomerTable();
        updateTopCandidate();
        
        // Prevent input fields from triggering scroll pause
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('click', e => e.stopPropagation());
            input.addEventListener('focus', e => e.stopPropagation());
        });
        
        // ==========================================
        // TIME SOLD COMPLIANCE SYSTEM
        // ==========================================
        
        // Default employee database (Denver Satellite Dept 889)
        const defaultEmployees = [
            {name: 'Sean R Macoomb', code: 'MACOS', email: 'sean.macoomb@duncanaviation.aero'},
            {name: 'Kenneth O Smith', code: 'SMIKZ', email: 'kenneth.smith@duncanaviation.aero'},
            {name: 'Michael Huber', code: 'HUBEM', email: 'michael.huber@duncanaviation.aero'},
            {name: 'Julia Langford', code: 'LANJU', email: 'julia.langford@duncanaviation.aero'},
            {name: 'Jose Noris', code: 'NORIJ', email: 'jose.noris@duncanaviation.aero'},
            {name: 'Armando Triana-Cruz', code: 'CRUZA', email: 'armando.triana-cruz@duncanaviation.aero'},
            {name: 'Douglas Riera Guzman', code: 'RIERD', email: 'douglas.rieraguzman@duncanaviation.aero'},
            {name: 'Andrew Watson', code: 'WATAN', email: 'andrew.watson@duncanaviation.aero'},
            {name: 'Kim D Owen', code: 'OWEKI', email: 'kim.owen@duncanaviation.aero'},
            {name: 'Guillermo Tovar Sanchez', code: 'TOVAG', email: 'guillermo.tovarsanchez@duncanaviation.aero'},
            {name: 'Juan R Medina', code: 'MEDIJ', email: 'juan.medina@duncanaviation.aero'},
            {name: 'John Watson', code: 'WATJO', email: 'john.watson@duncanaviation.aero'}
        ];
        
        function getEmployeeDatabase() {
            let db = localStorage.getItem('denver_employee_db');
            if (!db) {
                localStorage.setItem('denver_employee_db', JSON.stringify(defaultEmployees));
                return defaultEmployees;
            }
            return JSON.parse(db);
        }
        
        function saveEmployeeDatabase(db) {
            localStorage.setItem('denver_employee_db', JSON.stringify(db));
        }
        
        function getTimeSoldData() {
            let data = localStorage.getItem('denver_timesold_data');
            if (!data) return {};
            return JSON.parse(data);
        }
        
        function saveTimeSoldData(data) {
            localStorage.setItem('denver_timesold_data', JSON.stringify(data));
        }
        
        // Update time sold data for a specific date
        // Usage: updateTimeSoldData('2026-01-27', ['MACOS', 'SMIKZ', 'HUBEM', ...])
        window.updateTimeSoldData = function(dateStr, empCodesList) {
            const data = getTimeSoldData();
            data[dateStr] = empCodesList.map(c => c.toUpperCase());
            saveTimeSoldData(data);
            renderTimeSoldCompliance();
            console.log(`‚úÖ Updated time sold data for ${dateStr}: ${empCodesList.length} employees recorded`);
            return data[dateStr];
        };
        
        function getLastBusinessDay() {
            const today = new Date();
            let lastBiz = new Date(today);
            lastBiz.setDate(lastBiz.getDate() - 1);
            
            // Skip weekends
            while (lastBiz.getDay() === 0 || lastBiz.getDay() === 6) {
                lastBiz.setDate(lastBiz.getDate() - 1);
            }
            return lastBiz;
        }
        
        function formatDateForInput(date) {
            return date.toISOString().split('T')[0];
        }
        
        function formatDateDisplay(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
        }
        
        function setTimeSoldDateYesterday() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            document.getElementById('timeSoldCheckDate').value = formatDateForInput(yesterday);
            renderTimeSoldCompliance();
        }
        
        function setTimeSoldDateLastBusinessDay() {
            document.getElementById('timeSoldCheckDate').value = formatDateForInput(getLastBusinessDay());
            renderTimeSoldCompliance();
        }
        
        function renderTimeSoldCompliance() {
            const dateInput = document.getElementById('timeSoldCheckDate');
            if (!dateInput.value) {
                dateInput.value = formatDateForInput(getLastBusinessDay());
            }
            
            const checkDate = dateInput.value;
            const employees = getEmployeeDatabase();
            const timeSoldData = getTimeSoldData();
            const soldCodes = timeSoldData[checkDate] || [];
            
            const grid = document.getElementById('timeSoldGrid');
            const nonCompliantSection = document.getElementById('nonCompliantSection');
            const allCompliantSection = document.getElementById('allCompliantSection');
            const nonCompliantBody = document.getElementById('nonCompliantBody');
            const badge = document.getElementById('timeSoldBadge');
            
            let soldCount = 0;
            let notSoldCount = 0;
            let gridHtml = '';
            let nonCompliantHtml = '';
            const nonCompliantList = [];
            
            employees.forEach(emp => {
                const didSell = soldCodes.includes(emp.code.toUpperCase());
                
                if (didSell) {
                    soldCount++;
                    gridHtml += `<div style="background:#14532d;padding:10px;border-radius:8px;display:flex;align-items:center;gap:8px;">
                        <span style="color:#4ade80;font-size:1.2em;">‚úÖ</span>
                        <span style="color:#86efac;font-size:0.85em;">${emp.name.split(' ')[0]}</span>
                    </div>`;
                } else {
                    notSoldCount++;
                    nonCompliantList.push(emp);
                    gridHtml += `<div style="background:#7f1d1d;padding:10px;border-radius:8px;display:flex;align-items:center;gap:8px;">
                        <span style="color:#f87171;font-size:1.2em;">‚ùå</span>
                        <span style="color:#fca5a5;font-size:0.85em;">${emp.name.split(' ')[0]}</span>
                    </div>`;
                    
                    nonCompliantHtml += `<tr>
                        <td>${emp.name}</td>
                        <td style="color:#94a3b8;font-size:0.8em;">${emp.email}</td>
                        <td><button onclick="sendTimeSoldReminder('${emp.name.replace(/'/g, "\\'")}', '${emp.email}', '${checkDate}')" style="background:#ef4444;color:white;border:none;padding:4px 10px;border-radius:4px;font-size:0.8em;cursor:pointer;">üìß Send</button></td>
                    </tr>`;
                }
            });
            
            grid.innerHTML = gridHtml || '<div style="color:#64748b;text-align:center;grid-column:span 4;">No employee data. Add employees in Manage section.</div>';
            
            // Update stats
            document.getElementById('timeSoldCount').textContent = soldCount;
            document.getElementById('noTimeSoldCount').textContent = notSoldCount;
            const compliance = employees.length > 0 ? Math.round((soldCount / employees.length) * 100) : 0;
            document.getElementById('timeSoldCompliance').textContent = compliance + '%';
            document.getElementById('employeeDbCount').textContent = employees.length;
            
            // Update badge
            if (soldCodes.length === 0) {
                badge.textContent = 'No Data';
                badge.style.background = '#64748b';
            } else if (notSoldCount === 0) {
                badge.textContent = '‚úÖ All Compliant';
                badge.style.background = '#10b981';
            } else {
                badge.textContent = `‚ö†Ô∏è ${notSoldCount} Missing`;
                badge.style.background = '#ef4444';
            }
            
            // Show/hide sections
            if (notSoldCount > 0 && soldCodes.length > 0) {
                nonCompliantSection.style.display = 'block';
                allCompliantSection.style.display = 'none';
                nonCompliantBody.innerHTML = nonCompliantHtml;
                
                // Store list for "Send All" button
                window.currentNonCompliant = nonCompliantList;
                window.currentCheckDate = checkDate;
            } else if (soldCodes.length > 0) {
                nonCompliantSection.style.display = 'none';
                allCompliantSection.style.display = 'block';
            } else {
                nonCompliantSection.style.display = 'none';
                allCompliantSection.style.display = 'none';
            }
        }
        
        function sendTimeSoldReminder(name, email, dateStr) {
            const displayDate = formatDateDisplay(dateStr);
            const firstName = name.split(' ')[0];
            
            const subject = encodeURIComponent(`No time sold on ${displayDate}`);
            const body = encodeURIComponent(`${firstName},

There was no time sold on ${displayDate}. In order to accurately track A/B, hours must be sold to the respective work order upon completion of each daily task.

Thank you,

---
This is an automated message.`);
            
            window.open(`https://outlook.office.com/mail/deeplink/compose?to=${email}&subject=${subject}&body=${body}`, '_blank');
        }
        
        function sendAllTimeSoldReminders() {
            if (!window.currentNonCompliant || window.currentNonCompliant.length === 0) {
                alert('No non-compliant employees to email.');
                return;
            }
            
            if (!confirm(`Send reminder emails to ${window.currentNonCompliant.length} employees?`)) {
                return;
            }
            
            window.currentNonCompliant.forEach((emp, idx) => {
                setTimeout(() => {
                    sendTimeSoldReminder(emp.name, emp.email, window.currentCheckDate);
                }, idx * 500); // Stagger by 500ms to avoid popup blockers
            });
        }
        
        function toggleEmployeeManager() {
            const mgr = document.getElementById('employeeManager');
            mgr.style.display = mgr.style.display === 'none' ? 'block' : 'none';
            if (mgr.style.display === 'block') {
                renderEmployeeTable();
            }
        }
        
        function renderEmployeeTable() {
            const employees = getEmployeeDatabase();
            const tbody = document.getElementById('employeeDbBody');
            
            let html = '';
            employees.forEach(emp => {
                html += `<tr>
                    <td>${emp.name}</td>
                    <td style="color:#60a5fa;">${emp.code}</td>
                    <td style="color:#94a3b8;font-size:0.75em;">${emp.email}</td>
                    <td><button onclick="removeEmployee('${emp.code}')" style="background:transparent;color:#64748b;border:none;cursor:pointer;">‚úï</button></td>
                </tr>`;
            });
            
            tbody.innerHTML = html || '<tr><td colspan="4" style="color:#64748b;text-align:center;">No employees</td></tr>';
        }
        
        function addEmployeeToDb() {
            const name = document.getElementById('newEmpName').value.trim();
            const code = document.getElementById('newEmpCode').value.trim().toUpperCase();
            const email = document.getElementById('newEmpEmail').value.trim();
            const msgEl = document.getElementById('empAddMsg');
            
            if (!name || !code || !email) {
                msgEl.textContent = '‚ö†Ô∏è All fields required';
                msgEl.style.color = '#fca5a5';
                msgEl.style.display = 'block';
                setTimeout(() => msgEl.style.display = 'none', 3000);
                return;
            }
            
            const db = getEmployeeDatabase();
            if (db.some(e => e.code === code)) {
                msgEl.textContent = '‚ö†Ô∏è Employee code already exists';
                msgEl.style.color = '#fca5a5';
                msgEl.style.display = 'block';
                setTimeout(() => msgEl.style.display = 'none', 3000);
                return;
            }
            
            db.push({ name, code, email });
            db.sort((a, b) => a.name.localeCompare(b.name));
            saveEmployeeDatabase(db);
            
            document.getElementById('newEmpName').value = '';
            document.getElementById('newEmpCode').value = '';
            document.getElementById('newEmpEmail').value = '';
            
            msgEl.textContent = '‚úÖ Added ' + name;
            msgEl.style.color = '#86efac';
            msgEl.style.display = 'block';
            setTimeout(() => msgEl.style.display = 'none', 3000);
            
            renderEmployeeTable();
            renderTimeSoldCompliance();
        }
        
        function removeEmployee(code) {
            if (!confirm('Remove employee ' + code + '?')) return;
            let db = getEmployeeDatabase();
            db = db.filter(e => e.code !== code);
            saveEmployeeDatabase(db);
            renderEmployeeTable();
            renderTimeSoldCompliance();
        }
        
        // Initialize time sold compliance on page load
        renderTimeSoldCompliance();
        
        // ==========================================
        // DAILY CHECKLIST AUTO-RESET SYSTEM
        // ==========================================
        
        function getTodayString() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const year = String(now.getFullYear()).slice(-2);
            return `${month}/${day}/${year}`;
        }
        
        function getStorageKey() {
            return 'denver_checklist_' + getTodayString().replace(/\//g, '_');
        }
        
        function loadDailyChecklists() {
            const today = getTodayString();
            const storageKey = getStorageKey();
            
            // Update date badges
            document.getElementById('morningDate').textContent = today;
            document.getElementById('eveningDate').textContent = today;
            
            // Try to load saved state
            let savedState = localStorage.getItem(storageKey);
            
            if (savedState) {
                savedState = JSON.parse(savedState);
                
                // Restore checkbox states
                document.querySelectorAll('[data-checklist]').forEach(checkbox => {
                    const list = checkbox.dataset.checklist;
                    const item = checkbox.dataset.item;
                    const key = `${list}_${item}`;
                    
                    if (savedState.checks && savedState.checks[key]) {
                        checkbox.classList.add('checked');
                        // Update note if exists
                        const noteEl = document.getElementById(`${list}-note-${item}`);
                        if (noteEl && savedState.notes && savedState.notes[key]) {
                            noteEl.textContent = savedState.notes[key];
                            noteEl.style.color = '#10b981';
                        }
                    }
                });
                
                // Restore status texts
                if (savedState.reportStatus) {
                    document.getElementById('reportStatusText').textContent = savedState.reportStatus;
                }
                if (savedState.resultsStatus) {
                    document.getElementById('resultsStatusText').textContent = savedState.resultsStatus;
                }
            }
            
            // Clean up old entries (keep only last 7 days)
            cleanOldChecklistData();
        }
        
        function saveDailyChecklists() {
            const storageKey = getStorageKey();
            const state = {
                date: getTodayString(),
                checks: {},
                notes: {},
                reportStatus: document.getElementById('reportStatusText').textContent,
                resultsStatus: document.getElementById('resultsStatusText').textContent
            };
            
            document.querySelectorAll('[data-checklist]').forEach(checkbox => {
                const list = checkbox.dataset.checklist;
                const item = checkbox.dataset.item;
                const key = `${list}_${item}`;
                
                state.checks[key] = checkbox.classList.contains('checked');
                
                const noteEl = document.getElementById(`${list}-note-${item}`);
                if (noteEl && noteEl.textContent) {
                    state.notes[key] = noteEl.textContent;
                }
            });
            
            localStorage.setItem(storageKey, JSON.stringify(state));
        }
        
        function toggleDailyCheck(el) {
            el.classList.toggle('checked');
            
            const list = el.dataset.checklist;
            const item = el.dataset.item;
            const noteEl = document.getElementById(`${list}-note-${item}`);
            
            if (el.classList.contains('checked') && noteEl) {
                // Set completion note based on item
                const time = new Date().toLocaleTimeString('en-US', {hour: 'numeric', minute: '2-digit'});
                if (list === 'morning') {
                    if (item === '0') noteEl.textContent = `‚úì Processed @ ${time}`;
                    if (item === '1') noteEl.textContent = `‚úì Reviewed @ ${time}`;
                } else if (list === 'evening') {
                    if (item === '0') noteEl.textContent = `‚úì Pulled @ ${time}`;
                    if (item === '1') noteEl.textContent = `‚úì Uploaded @ ${time}`;
                    if (item === '2') noteEl.textContent = `‚úì Billed @ ${time}`;
                }
                if (noteEl.textContent) noteEl.style.color = '#10b981';
            } else if (noteEl) {
                noteEl.textContent = '';
            }
            
            saveDailyChecklists();
        }
        
        function cleanOldChecklistData() {
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('denver_checklist_')) {
                    // Check if older than 7 days
                    const datePart = key.replace('denver_checklist_', '').replace(/_/g, '/');
                    const entryDate = new Date(datePart);
                    const now = new Date();
                    const diffDays = (now - entryDate) / (1000 * 60 * 60 * 24);
                    if (diffDays > 7) {
                        keysToRemove.push(key);
                    }
                }
            }
            keysToRemove.forEach(key => localStorage.removeItem(key));
        }
        
        // Check for midnight reset every minute
        let lastCheckedDate = getTodayString();
        setInterval(() => {
            const currentDate = getTodayString();
            if (currentDate !== lastCheckedDate) {
                // Date changed! Reload checklists (will be fresh for new day)
                lastCheckedDate = currentDate;
                loadDailyChecklists();
                console.log('üåÖ New day detected - checklists reset!');
            }
        }, 60000); // Check every minute
        
        // Initialize on page load
        loadDailyChecklists();
    </script>
</body>
</html>
